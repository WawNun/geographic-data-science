
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Virginia independent cities &#8212; Geographic Data Science with Python</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://geographicdata.science/book/data/us_county_income/020_virginia.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://geographicdata.science/book/data/us_county_income/020_virginia.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Virginia independent cities" />
<meta property="og:description" content="Virginia independent cities  Reference https://en.wikipedia.org/wiki/Independent_city_(United_States)  In the United States, an independent city is a city that " />
<meta property="og:image"       content="https://geographicdata.science/book/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Geographic Data Science with Python</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Home
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/00_toc.html">
   Table of Contents
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/references.html">
   References
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Part I - Building Blocks
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro_part_i.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/01_geospatial_computational_environment.html">
   Geospatial Computational Environment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/02_spatial_data.html">
   Geographic thinking for data scientists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/03_spatial_data_processing.html">
   Spatial Data Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/04_spatial_weights.html">
   Spatial Weights
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Part II - Spatial Data Analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro_part_ii.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/05_choropleth.html">
   Choropleth Mapping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/06_spatial_autocorrelation.html">
   Global Spatial Autocorrelation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/07_local_autocorrelation.html">
   Local Spatial Autocorrelation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/08_point_pattern_analysis.html">
   Point Pattern Analysis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Part III - Advanced Topics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro_part_ii.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/09_spatial_inequality.html">
   Spatial Inequality
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/10_clustering_and_regionalization.html">
   Clustering &amp; Regionalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/11_regression.html">
   Spatial Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notebooks/12_feature_engineering.html">
   Spatial Feature Engineering
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Datasets
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../airbnb/regression_cleaning.html">
   AirBnb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../airports/airports_cleaning.html">
   Airports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../brexit/brexit_cleaning.html">
   Brexit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../countries/countries_cleaning.html">
   Countries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../h3_grid/build_sd_h3_grid.html">
   H3 Grid
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mexico/README.html">
   Mexico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../nasadem/build_nasadem_sd.html">
   NASA DEM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sandiego/sandiego_tracts_cleaning.html">
   San Diego Tracts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../texas/README.html">
   Texas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tokyo/tokyo_cleaning.html">
   Tokyo Photographs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="README.html">
   US County Income 1969-2017
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/data/us_county_income/020_virginia.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/gdsbook/book/master?urlpath=lab/tree/data/us_county_income/020_virginia.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/gdsbook/book/blob/master/data/us_county_income/020_virginia.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Virginia independent cities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#from-bea-income-data">
     From BEA Income Data:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#virginia">
     Virginia
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#approach">
     Approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gdf-records-missing-income-values">
   gdf records missing income values
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#match-combinations-to-rows-of-df">
   Match combinations to rows of df
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reverse-matching">
   Reverse Matching
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="virginia-independent-cities">
<h1>Virginia independent cities<a class="headerlink" href="#virginia-independent-cities" title="Permalink to this headline">¶</a></h1>
<p>Reference https://en.wikipedia.org/wiki/Independent_city_(United_States)</p>
<blockquote>
<div><p>In the United States, an independent city is a city that is not in the territory of any county or counties with exceptions noted below. Of the 41 independent U.S. cities,[1] 38 are in Virginia, whose state constitution makes them a special case. The three independent cities outside Virginia are Baltimore, Maryland; St. Louis, Missouri; and Carson City, Nevada. The U.S. Census Bureau uses counties as its base unit for presentation of statistical information, and treats independent cities as county equivalents for those purposes. The most populous of them is Baltimore, Maryland.</p>
</div></blockquote>
<div class="section" id="from-bea-income-data">
<h2>From BEA Income Data:<a class="headerlink" href="#from-bea-income-data" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Virginia combination areas consist of one or two independent cities with 1980 populations of less than 100,000 combined with an adjacent county. The county name appears first, followed by the city name(s). Separate estimates for the jurisdictions making up the combination area are not available. Bedford County, VA includes the independent city of Bedford for all years.</p>
</div></blockquote>
</div>
<div class="section" id="virginia">
<h2>Virginia<a class="headerlink" href="#virginia" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The Commonwealth of Virginia is divided into 95 counties, along with 38 independent cities that are considered county-equivalents for census purposes. The map in this article, taken from the official United States Census Bureau site, includes Clifton Forge and Bedford as independent cities. This reflected the political reality at the time of the 2000 Census. However, both have since chosen to revert to town status. In Virginia, cities are co-equal levels of government to counties, but towns are part of counties. For some counties, for statistical purposes, the Bureau of Economic Analysis combines any independent cities with the county that it was once part of (before the legislation creating independent cities took place in 1871).</p>
</div></blockquote>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/List_of_cities_and_counties_in_Virginia">Source</a></p>
</div>
<div class="section" id="approach">
<h2>Approach<a class="headerlink" href="#approach" title="Permalink to this headline">¶</a></h2>
<p>Dissolve boundaries of independent cities that BEA does not disclose values for with their adjacent county.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;51.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>GeoFIPS</th>
      <th>GeoName</th>
      <th>Region</th>
      <th>TableName</th>
      <th>LineCode</th>
      <th>IndustryClassification</th>
      <th>Description</th>
      <th>Unit</th>
      <th>1969</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8670</td>
      <td>"51000"</td>
      <td>Virginia</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>1</td>
      <td>...</td>
      <td>Personal income (thousands of dollars)</td>
      <td>Thousands of dollars</td>
      <td>17847652</td>
      <td>...</td>
      <td>356434411</td>
      <td>348944176</td>
      <td>364382497</td>
      <td>386298008</td>
      <td>404772481</td>
      <td>402064568</td>
      <td>420235927</td>
      <td>440823733</td>
      <td>448683501</td>
      <td>466743276</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8671</td>
      <td>"51000"</td>
      <td>Virginia</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>2</td>
      <td>...</td>
      <td>Population (persons) 1/</td>
      <td>Number of persons</td>
      <td>4614000</td>
      <td>...</td>
      <td>7833496</td>
      <td>7925937</td>
      <td>8025206</td>
      <td>8107548</td>
      <td>8188656</td>
      <td>8261689</td>
      <td>8316902</td>
      <td>8366767</td>
      <td>8414380</td>
      <td>8470020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8672</td>
      <td>"51000"</td>
      <td>Virginia</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>3</td>
      <td>...</td>
      <td>Per capita personal income (dollars) 2/</td>
      <td>Dollars</td>
      <td>3868</td>
      <td>...</td>
      <td>45501</td>
      <td>44026</td>
      <td>45405</td>
      <td>47647</td>
      <td>49431</td>
      <td>48666</td>
      <td>50528</td>
      <td>52687</td>
      <td>53323</td>
      <td>55105</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8673</td>
      <td>"51001"</td>
      <td>Accomack, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>1</td>
      <td>...</td>
      <td>Personal income (thousands of dollars)</td>
      <td>Thousands of dollars</td>
      <td>72875</td>
      <td>...</td>
      <td>1090928</td>
      <td>1089574</td>
      <td>1112288</td>
      <td>1129193</td>
      <td>1181700</td>
      <td>1188926</td>
      <td>1227111</td>
      <td>1277179</td>
      <td>1283155</td>
      <td>1324623</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8674</td>
      <td>"51001"</td>
      <td>Accomack, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>2</td>
      <td>...</td>
      <td>Population (persons) 1/</td>
      <td>Number of persons</td>
      <td>29308</td>
      <td>...</td>
      <td>33970</td>
      <td>33415</td>
      <td>33147</td>
      <td>33222</td>
      <td>33264</td>
      <td>32963</td>
      <td>32965</td>
      <td>32911</td>
      <td>32818</td>
      <td>32545</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 58 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv</span><span class="p">[</span><span class="s1">&#39;GeoFIPS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fip</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">fip</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">GeoFIPS</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;tl_2019_us_county.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>gdf = geopandas.read_file(“zip:tl_2019_us_county.zip!tl_2019_us_county.shp”)
zipfile = “zip:tl_2019_us_county.zip!tl_2019_us_county.shp”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="o">==</span><span class="s2">&quot;51&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_8_1.png" src="../../_images/020_virginia_8_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>CBSAFP</th>
      <th>METDIVFP</th>
      <th>FUNCSTAT</th>
      <th>ALAND</th>
      <th>AWATER</th>
      <th>INTPTLAT</th>
      <th>INTPTLON</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>51</td>
      <td>775</td>
      <td>01789074</td>
      <td>51775</td>
      <td>Salem</td>
      <td>Salem city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>40220</td>
      <td>None</td>
      <td>F</td>
      <td>37602710</td>
      <td>275156</td>
      <td>+37.2853329</td>
      <td>-080.0552407</td>
      <td>POLYGON ((-80.12049 37.28705, -80.12015 37.287...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>51</td>
      <td>121</td>
      <td>01674630</td>
      <td>51121</td>
      <td>Montgomery</td>
      <td>Montgomery County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>13980</td>
      <td>None</td>
      <td>A</td>
      <td>1001921573</td>
      <td>6289787</td>
      <td>+37.1755344</td>
      <td>-080.3877913</td>
      <td>MULTIPOLYGON (((-80.55224 37.16172, -80.55228 ...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>51</td>
      <td>735</td>
      <td>01498436</td>
      <td>51735</td>
      <td>Poquoson</td>
      <td>Poquoson city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>F</td>
      <td>39837595</td>
      <td>163455830</td>
      <td>+37.1283599</td>
      <td>-076.3035337</td>
      <td>POLYGON ((-76.41367 37.13862, -76.41338 37.139...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>51</td>
      <td>095</td>
      <td>01480135</td>
      <td>51095</td>
      <td>James City</td>
      <td>James City County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>A</td>
      <td>368724192</td>
      <td>95246387</td>
      <td>+37.3248367</td>
      <td>-076.7778878</td>
      <td>POLYGON ((-76.89270 37.42427, -76.89273 37.424...</td>
    </tr>
    <tr>
      <th>49</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>A</td>
      <td>697237202</td>
      <td>28088011</td>
      <td>+38.4132608</td>
      <td>-077.4513342</td>
      <td>POLYGON ((-77.58878 38.50404, -77.58295 38.508...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">csv</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>GeoFIPS</th>
      <th>GeoName</th>
      <th>Region</th>
      <th>TableName</th>
      <th>LineCode</th>
      <th>IndustryClassification</th>
      <th>Description</th>
      <th>Unit</th>
      <th>1969</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8670</td>
      <td>51000</td>
      <td>Virginia</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>1</td>
      <td>...</td>
      <td>Personal income (thousands of dollars)</td>
      <td>Thousands of dollars</td>
      <td>17847652</td>
      <td>...</td>
      <td>356434411</td>
      <td>348944176</td>
      <td>364382497</td>
      <td>386298008</td>
      <td>404772481</td>
      <td>402064568</td>
      <td>420235927</td>
      <td>440823733</td>
      <td>448683501</td>
      <td>466743276</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8671</td>
      <td>51000</td>
      <td>Virginia</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>2</td>
      <td>...</td>
      <td>Population (persons) 1/</td>
      <td>Number of persons</td>
      <td>4614000</td>
      <td>...</td>
      <td>7833496</td>
      <td>7925937</td>
      <td>8025206</td>
      <td>8107548</td>
      <td>8188656</td>
      <td>8261689</td>
      <td>8316902</td>
      <td>8366767</td>
      <td>8414380</td>
      <td>8470020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8672</td>
      <td>51000</td>
      <td>Virginia</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>3</td>
      <td>...</td>
      <td>Per capita personal income (dollars) 2/</td>
      <td>Dollars</td>
      <td>3868</td>
      <td>...</td>
      <td>45501</td>
      <td>44026</td>
      <td>45405</td>
      <td>47647</td>
      <td>49431</td>
      <td>48666</td>
      <td>50528</td>
      <td>52687</td>
      <td>53323</td>
      <td>55105</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8673</td>
      <td>51001</td>
      <td>Accomack, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>1</td>
      <td>...</td>
      <td>Personal income (thousands of dollars)</td>
      <td>Thousands of dollars</td>
      <td>72875</td>
      <td>...</td>
      <td>1090928</td>
      <td>1089574</td>
      <td>1112288</td>
      <td>1129193</td>
      <td>1181700</td>
      <td>1188926</td>
      <td>1227111</td>
      <td>1277179</td>
      <td>1283155</td>
      <td>1324623</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8674</td>
      <td>51001</td>
      <td>Accomack, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>2</td>
      <td>...</td>
      <td>Population (persons) 1/</td>
      <td>Number of persons</td>
      <td>29308</td>
      <td>...</td>
      <td>33970</td>
      <td>33415</td>
      <td>33147</td>
      <td>33222</td>
      <td>33264</td>
      <td>32963</td>
      <td>32965</td>
      <td>32911</td>
      <td>32818</td>
      <td>32545</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 58 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;GEOID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">GeoFIPS</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">GEOID</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      51000
1      51000
2      51000
3      51001
4      51001
       ...  
313    51955
314    51955
315    51958
316    51958
317    51958
Name: GEOID, Length: 318, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="gdf-records-missing-income-values">
<h1>gdf records missing income values<a class="headerlink" href="#gdf-records-missing-income-values" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data = data[data.LineCode==3]</span>
<span class="n">merged_gdf</span> <span class="o">=</span> <span class="n">virginia_gdf</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;GEOID&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_16_1.png" src="../../_images/020_virginia_16_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>5598667</td>
      <td>5771841</td>
      <td>6051523</td>
      <td>6377898</td>
      <td>6564332</td>
      <td>6618516</td>
      <td>6806720</td>
      <td>7145523</td>
      <td>7413434</td>
      <td>7779485</td>
    </tr>
    <tr>
      <th>1</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>124323</td>
      <td>126449</td>
      <td>129822</td>
      <td>132207</td>
      <td>133376</td>
      <td>135978</td>
      <td>138802</td>
      <td>140891</td>
      <td>143477</td>
      <td>146649</td>
    </tr>
    <tr>
      <th>2</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>45033</td>
      <td>45646</td>
      <td>46614</td>
      <td>48242</td>
      <td>49217</td>
      <td>48673</td>
      <td>49039</td>
      <td>50717</td>
      <td>51670</td>
      <td>53048</td>
    </tr>
    <tr>
      <th>3</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>236619</td>
      <td>237659</td>
      <td>235027</td>
      <td>241403</td>
      <td>244447</td>
      <td>243534</td>
      <td>255985</td>
      <td>274412</td>
      <td>263711</td>
      <td>277471</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>7061</td>
      <td>7037</td>
      <td>7045</td>
      <td>6923</td>
      <td>6839</td>
      <td>6788</td>
      <td>6781</td>
      <td>6670</td>
      <td>6570</td>
      <td>6540</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_gdf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>82.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matched_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">merged_gdf</span><span class="o">.</span><span class="n">NAMELSAD</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matched_names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Accomack County&#39;,
 &#39;Alexandria city&#39;,
 &#39;Amelia County&#39;,
 &#39;Amherst County&#39;,
 &#39;Appomattox County&#39;,
 &#39;Arlington County&#39;,
 &#39;Bath County&#39;,
 &#39;Bedford County&#39;,
 &#39;Bland County&#39;,
 &#39;Botetourt County&#39;,
 &#39;Brunswick County&#39;,
 &#39;Buchanan County&#39;,
 &#39;Buckingham County&#39;,
 &#39;Caroline County&#39;,
 &#39;Charles City County&#39;,
 &#39;Charlotte County&#39;,
 &#39;Chesapeake city&#39;,
 &#39;Chesterfield County&#39;,
 &#39;Clarke County&#39;,
 &#39;Craig County&#39;,
 &#39;Culpeper County&#39;,
 &#39;Cumberland County&#39;,
 &#39;Dickenson County&#39;,
 &#39;Essex County&#39;,
 &#39;Fauquier County&#39;,
 &#39;Floyd County&#39;,
 &#39;Fluvanna County&#39;,
 &#39;Franklin County&#39;,
 &#39;Giles County&#39;,
 &#39;Gloucester County&#39;,
 &#39;Goochland County&#39;,
 &#39;Grayson County&#39;,
 &#39;Greene County&#39;,
 &#39;Halifax County&#39;,
 &#39;Hampton city&#39;,
 &#39;Hanover County&#39;,
 &#39;Henrico County&#39;,
 &#39;Highland County&#39;,
 &#39;Isle of Wight County&#39;,
 &#39;King George County&#39;,
 &#39;King William County&#39;,
 &#39;King and Queen County&#39;,
 &#39;Lancaster County&#39;,
 &#39;Lee County&#39;,
 &#39;Loudoun County&#39;,
 &#39;Louisa County&#39;,
 &#39;Lunenburg County&#39;,
 &#39;Madison County&#39;,
 &#39;Mathews County&#39;,
 &#39;Mecklenburg County&#39;,
 &#39;Middlesex County&#39;,
 &#39;Nelson County&#39;,
 &#39;New Kent County&#39;,
 &#39;Newport News city&#39;,
 &#39;Norfolk city&#39;,
 &#39;Northampton County&#39;,
 &#39;Northumberland County&#39;,
 &#39;Nottoway County&#39;,
 &#39;Orange County&#39;,
 &#39;Page County&#39;,
 &#39;Patrick County&#39;,
 &#39;Portsmouth city&#39;,
 &#39;Powhatan County&#39;,
 &#39;Prince Edward County&#39;,
 &#39;Pulaski County&#39;,
 &#39;Rappahannock County&#39;,
 &#39;Richmond County&#39;,
 &#39;Richmond city&#39;,
 &#39;Roanoke city&#39;,
 &#39;Russell County&#39;,
 &#39;Scott County&#39;,
 &#39;Shenandoah County&#39;,
 &#39;Smyth County&#39;,
 &#39;Stafford County&#39;,
 &#39;Suffolk city&#39;,
 &#39;Surry County&#39;,
 &#39;Sussex County&#39;,
 &#39;Tazewell County&#39;,
 &#39;Virginia Beach city&#39;,
 &#39;Warren County&#39;,
 &#39;Westmoreland County&#39;,
 &#39;Wythe County&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_gdf</span> <span class="o">=</span> <span class="n">virginia_gdf</span><span class="p">[</span><span class="o">~</span><span class="n">virginia_gdf</span><span class="o">.</span><span class="n">GEOID</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">merged_gdf</span><span class="o">.</span><span class="n">GEOID</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">missing_gdf</span><span class="o">.</span><span class="n">NAMELSAD</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Albemarle County&#39;,
 &#39;Alleghany County&#39;,
 &#39;Augusta County&#39;,
 &#39;Bristol city&#39;,
 &#39;Buena Vista city&#39;,
 &#39;Campbell County&#39;,
 &#39;Carroll County&#39;,
 &#39;Charlottesville city&#39;,
 &#39;Colonial Heights city&#39;,
 &#39;Covington city&#39;,
 &#39;Danville city&#39;,
 &#39;Dinwiddie County&#39;,
 &#39;Emporia city&#39;,
 &#39;Fairfax County&#39;,
 &#39;Fairfax city&#39;,
 &#39;Falls Church city&#39;,
 &#39;Franklin city&#39;,
 &#39;Frederick County&#39;,
 &#39;Fredericksburg city&#39;,
 &#39;Galax city&#39;,
 &#39;Greensville County&#39;,
 &#39;Harrisonburg city&#39;,
 &#39;Henry County&#39;,
 &#39;Hopewell city&#39;,
 &#39;James City County&#39;,
 &#39;Lexington city&#39;,
 &#39;Lynchburg city&#39;,
 &#39;Manassas Park city&#39;,
 &#39;Manassas city&#39;,
 &#39;Martinsville city&#39;,
 &#39;Montgomery County&#39;,
 &#39;Norton city&#39;,
 &#39;Petersburg city&#39;,
 &#39;Pittsylvania County&#39;,
 &#39;Poquoson city&#39;,
 &#39;Prince George County&#39;,
 &#39;Prince William County&#39;,
 &#39;Radford city&#39;,
 &#39;Roanoke County&#39;,
 &#39;Rockbridge County&#39;,
 &#39;Rockingham County&#39;,
 &#39;Salem city&#39;,
 &#39;Southampton County&#39;,
 &#39;Spotsylvania County&#39;,
 &#39;Staunton city&#39;,
 &#39;Washington County&#39;,
 &#39;Waynesboro city&#39;,
 &#39;Williamsburg city&#39;,
 &#39;Winchester city&#39;,
 &#39;Wise County&#39;,
 &#39;York County&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_24_1.png" src="../../_images/020_virginia_24_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_gdf</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(51, 18)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_gdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>CBSAFP</th>
      <th>METDIVFP</th>
      <th>FUNCSTAT</th>
      <th>ALAND</th>
      <th>AWATER</th>
      <th>INTPTLAT</th>
      <th>INTPTLON</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>51</td>
      <td>775</td>
      <td>01789074</td>
      <td>51775</td>
      <td>Salem</td>
      <td>Salem city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>40220</td>
      <td>None</td>
      <td>F</td>
      <td>37602710</td>
      <td>275156</td>
      <td>+37.2853329</td>
      <td>-080.0552407</td>
      <td>POLYGON ((-80.12049 37.28705, -80.12015 37.287...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>51</td>
      <td>121</td>
      <td>01674630</td>
      <td>51121</td>
      <td>Montgomery</td>
      <td>Montgomery County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>13980</td>
      <td>None</td>
      <td>A</td>
      <td>1001921573</td>
      <td>6289787</td>
      <td>+37.1755344</td>
      <td>-080.3877913</td>
      <td>MULTIPOLYGON (((-80.55224 37.16172, -80.55228 ...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>51</td>
      <td>735</td>
      <td>01498436</td>
      <td>51735</td>
      <td>Poquoson</td>
      <td>Poquoson city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>F</td>
      <td>39837595</td>
      <td>163455830</td>
      <td>+37.1283599</td>
      <td>-076.3035337</td>
      <td>POLYGON ((-76.41367 37.13862, -76.41338 37.139...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>51</td>
      <td>095</td>
      <td>01480135</td>
      <td>51095</td>
      <td>James City</td>
      <td>James City County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>A</td>
      <td>368724192</td>
      <td>95246387</td>
      <td>+37.3248367</td>
      <td>-076.7778878</td>
      <td>POLYGON ((-76.89270 37.42427, -76.89273 37.424...</td>
    </tr>
    <tr>
      <th>268</th>
      <td>51</td>
      <td>089</td>
      <td>01502770</td>
      <td>51089</td>
      <td>Henry</td>
      <td>Henry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>32300</td>
      <td>None</td>
      <td>A</td>
      <td>990284619</td>
      <td>5269785</td>
      <td>+36.7814785</td>
      <td>-079.7592313</td>
      <td>POLYGON ((-80.06909 36.67402, -80.06911 36.674...</td>
    </tr>
    <tr>
      <th>302</th>
      <td>51</td>
      <td>540</td>
      <td>01789068</td>
      <td>51540</td>
      <td>Charlottesville</td>
      <td>Charlottesville city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>16820</td>
      <td>None</td>
      <td>F</td>
      <td>26533570</td>
      <td>47161</td>
      <td>+38.0376579</td>
      <td>-078.4853806</td>
      <td>POLYGON ((-78.52368 38.02233, -78.52363 38.022...</td>
    </tr>
    <tr>
      <th>317</th>
      <td>51</td>
      <td>820</td>
      <td>01498443</td>
      <td>51820</td>
      <td>Waynesboro</td>
      <td>Waynesboro city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>277</td>
      <td>44420</td>
      <td>None</td>
      <td>F</td>
      <td>38771594</td>
      <td>364644</td>
      <td>+38.0671571</td>
      <td>-078.9014197</td>
      <td>POLYGON ((-78.94851 38.06810, -78.94911 38.068...</td>
    </tr>
    <tr>
      <th>377</th>
      <td>51</td>
      <td>595</td>
      <td>01498422</td>
      <td>51595</td>
      <td>Emporia</td>
      <td>Emporia city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>F</td>
      <td>17881071</td>
      <td>165621</td>
      <td>+36.6961820</td>
      <td>-077.5359753</td>
      <td>POLYGON ((-77.56389 36.70307, -77.56355 36.703...</td>
    </tr>
    <tr>
      <th>402</th>
      <td>51</td>
      <td>580</td>
      <td>01789069</td>
      <td>51580</td>
      <td>Covington</td>
      <td>Covington city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>F</td>
      <td>14163842</td>
      <td>521492</td>
      <td>+37.7810603</td>
      <td>-079.9854337</td>
      <td>POLYGON ((-80.00899 37.76259, -80.00889 37.762...</td>
    </tr>
    <tr>
      <th>423</th>
      <td>51</td>
      <td>005</td>
      <td>01673675</td>
      <td>51005</td>
      <td>Alleghany</td>
      <td>Alleghany County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>A</td>
      <td>1156608818</td>
      <td>8170515</td>
      <td>+37.7879048</td>
      <td>-080.0086690</td>
      <td>POLYGON ((-80.20146 37.82581, -80.20117 37.826...</td>
    </tr>
    <tr>
      <th>712</th>
      <td>51</td>
      <td>610</td>
      <td>01498423</td>
      <td>51610</td>
      <td>Falls Church</td>
      <td>Falls Church city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>F</td>
      <td>5300262</td>
      <td>32</td>
      <td>+38.8847220</td>
      <td>-077.1756027</td>
      <td>POLYGON ((-77.19499 38.89846, -77.19499 38.898...</td>
    </tr>
    <tr>
      <th>998</th>
      <td>51</td>
      <td>750</td>
      <td>01498438</td>
      <td>51750</td>
      <td>Radford</td>
      <td>Radford city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>13980</td>
      <td>None</td>
      <td>F</td>
      <td>25061727</td>
      <td>858287</td>
      <td>+37.1201194</td>
      <td>-080.5591473</td>
      <td>POLYGON ((-80.59609 37.12157, -80.59555 37.123...</td>
    </tr>
    <tr>
      <th>1115</th>
      <td>51</td>
      <td>600</td>
      <td>01789070</td>
      <td>51600</td>
      <td>Fairfax</td>
      <td>Fairfax city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>F</td>
      <td>16162729</td>
      <td>84155</td>
      <td>+38.8531833</td>
      <td>-077.2990252</td>
      <td>POLYGON ((-77.33485 38.85374, -77.33480 38.853...</td>
    </tr>
    <tr>
      <th>1178</th>
      <td>51</td>
      <td>620</td>
      <td>01498424</td>
      <td>51620</td>
      <td>Franklin</td>
      <td>Franklin city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>F</td>
      <td>21438217</td>
      <td>227442</td>
      <td>+36.6840142</td>
      <td>-076.9413956</td>
      <td>POLYGON ((-76.96941 36.69630, -76.96940 36.696...</td>
    </tr>
    <tr>
      <th>1182</th>
      <td>51</td>
      <td>660</td>
      <td>01498563</td>
      <td>51660</td>
      <td>Harrisonburg</td>
      <td>Harrisonburg city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>277</td>
      <td>25500</td>
      <td>None</td>
      <td>F</td>
      <td>44908386</td>
      <td>131080</td>
      <td>+38.4362547</td>
      <td>-078.8733028</td>
      <td>POLYGON ((-78.91787 38.39415, -78.91769 38.394...</td>
    </tr>
    <tr>
      <th>1195</th>
      <td>51</td>
      <td>530</td>
      <td>01498417</td>
      <td>51530</td>
      <td>Buena Vista</td>
      <td>Buena Vista city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>F</td>
      <td>16674748</td>
      <td>219580</td>
      <td>+37.7293448</td>
      <td>-079.3581337</td>
      <td>POLYGON ((-79.38151 37.74215, -79.38113 37.742...</td>
    </tr>
    <tr>
      <th>1274</th>
      <td>51</td>
      <td>143</td>
      <td>01480157</td>
      <td>51143</td>
      <td>Pittsylvania</td>
      <td>Pittsylvania County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>19260</td>
      <td>None</td>
      <td>A</td>
      <td>2509705662</td>
      <td>23903850</td>
      <td>+36.8217206</td>
      <td>-079.3985019</td>
      <td>POLYGON ((-79.36943 36.63507, -79.36944 36.635...</td>
    </tr>
    <tr>
      <th>1351</th>
      <td>51</td>
      <td>153</td>
      <td>01480161</td>
      <td>51153</td>
      <td>Prince William</td>
      <td>Prince William County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>A</td>
      <td>869574665</td>
      <td>30876519</td>
      <td>+38.7011187</td>
      <td>-077.4795791</td>
      <td>MULTIPOLYGON (((-77.57948 38.62765, -77.57955 ...</td>
    </tr>
    <tr>
      <th>1476</th>
      <td>51</td>
      <td>685</td>
      <td>01498431</td>
      <td>51685</td>
      <td>Manassas Park</td>
      <td>Manassas Park city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>F</td>
      <td>6538719</td>
      <td>616</td>
      <td>+38.7689451</td>
      <td>-077.4487670</td>
      <td>POLYGON ((-77.47911 38.78225, -77.47887 38.782...</td>
    </tr>
    <tr>
      <th>1478</th>
      <td>51</td>
      <td>035</td>
      <td>01480108</td>
      <td>51035</td>
      <td>Carroll</td>
      <td>Carroll County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>A</td>
      <td>1229582397</td>
      <td>7586189</td>
      <td>+36.7319632</td>
      <td>-080.7278307</td>
      <td>POLYGON ((-80.85642 36.84820, -80.85630 36.848...</td>
    </tr>
    <tr>
      <th>1563</th>
      <td>51</td>
      <td>840</td>
      <td>01789077</td>
      <td>51840</td>
      <td>Winchester</td>
      <td>Winchester city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>548</td>
      <td>49020</td>
      <td>None</td>
      <td>F</td>
      <td>23809495</td>
      <td>54462</td>
      <td>+39.1738688</td>
      <td>-078.1763562</td>
      <td>POLYGON ((-78.20050 39.18016, -78.20045 39.180...</td>
    </tr>
    <tr>
      <th>1678</th>
      <td>51</td>
      <td>191</td>
      <td>01498359</td>
      <td>51191</td>
      <td>Washington</td>
      <td>Washington County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>304</td>
      <td>28700</td>
      <td>None</td>
      <td>A</td>
      <td>1453399740</td>
      <td>12984238</td>
      <td>+36.7478138</td>
      <td>-081.9503218</td>
      <td>POLYGON ((-82.12196 36.64694, -82.12157 36.646...</td>
    </tr>
    <tr>
      <th>1700</th>
      <td>51</td>
      <td>161</td>
      <td>01480165</td>
      <td>51161</td>
      <td>Roanoke</td>
      <td>Roanoke County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>40220</td>
      <td>None</td>
      <td>A</td>
      <td>648906307</td>
      <td>1762677</td>
      <td>+37.3435877</td>
      <td>-079.9439958</td>
      <td>POLYGON ((-79.94562 37.36300, -79.94448 37.362...</td>
    </tr>
    <tr>
      <th>1701</th>
      <td>51</td>
      <td>015</td>
      <td>01480098</td>
      <td>51015</td>
      <td>Augusta</td>
      <td>Augusta County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>277</td>
      <td>44420</td>
      <td>None</td>
      <td>A</td>
      <td>2504708348</td>
      <td>9537633</td>
      <td>+38.1719106</td>
      <td>-079.1475571</td>
      <td>POLYGON ((-79.36786 38.01803, -79.37404 38.021...</td>
    </tr>
    <tr>
      <th>1713</th>
      <td>51</td>
      <td>590</td>
      <td>01498421</td>
      <td>51590</td>
      <td>Danville</td>
      <td>Danville city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>19260</td>
      <td>None</td>
      <td>F</td>
      <td>110844523</td>
      <td>2341364</td>
      <td>+36.5833337</td>
      <td>-079.4080707</td>
      <td>POLYGON ((-79.51926 36.60212, -79.51918 36.602...</td>
    </tr>
    <tr>
      <th>1727</th>
      <td>51</td>
      <td>670</td>
      <td>01498428</td>
      <td>51670</td>
      <td>Hopewell</td>
      <td>Hopewell city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>40060</td>
      <td>None</td>
      <td>F</td>
      <td>26817671</td>
      <td>1228128</td>
      <td>+37.2910098</td>
      <td>-077.2989443</td>
      <td>POLYGON ((-77.33777 37.30648, -77.33773 37.307...</td>
    </tr>
    <tr>
      <th>1855</th>
      <td>51</td>
      <td>678</td>
      <td>01789071</td>
      <td>51678</td>
      <td>Lexington</td>
      <td>Lexington city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>F</td>
      <td>6473000</td>
      <td>67783</td>
      <td>+37.7823316</td>
      <td>-079.4443196</td>
      <td>POLYGON ((-79.46158 37.78636, -79.45943 37.788...</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>51</td>
      <td>003</td>
      <td>01675170</td>
      <td>51003</td>
      <td>Albemarle</td>
      <td>Albemarle County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>16820</td>
      <td>None</td>
      <td>A</td>
      <td>1866007829</td>
      <td>14230114</td>
      <td>+38.0241841</td>
      <td>-078.5535056</td>
      <td>POLYGON ((-78.80140 37.98263, -78.80241 37.984...</td>
    </tr>
    <tr>
      <th>2013</th>
      <td>51</td>
      <td>081</td>
      <td>01501122</td>
      <td>51081</td>
      <td>Greensville</td>
      <td>Greensville County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>A</td>
      <td>764634553</td>
      <td>4086108</td>
      <td>+36.6803363</td>
      <td>-077.5602774</td>
      <td>POLYGON ((-77.65584 36.71354, -77.65587 36.714...</td>
    </tr>
    <tr>
      <th>2072</th>
      <td>51</td>
      <td>053</td>
      <td>01690739</td>
      <td>51053</td>
      <td>Dinwiddie</td>
      <td>Dinwiddie County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>40060</td>
      <td>None</td>
      <td>A</td>
      <td>1305053884</td>
      <td>8992266</td>
      <td>+37.0734984</td>
      <td>-077.6354922</td>
      <td>POLYGON ((-77.58916 37.24629, -77.58898 37.246...</td>
    </tr>
    <tr>
      <th>2138</th>
      <td>51</td>
      <td>520</td>
      <td>01498416</td>
      <td>51520</td>
      <td>Bristol</td>
      <td>Bristol city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>304</td>
      <td>28700</td>
      <td>None</td>
      <td>F</td>
      <td>33420176</td>
      <td>322409</td>
      <td>+36.6169541</td>
      <td>-082.1575641</td>
      <td>MULTIPOLYGON (((-82.12157 36.64631, -82.12196 ...</td>
    </tr>
    <tr>
      <th>2221</th>
      <td>51</td>
      <td>720</td>
      <td>01498434</td>
      <td>51720</td>
      <td>Norton</td>
      <td>Norton city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>13720</td>
      <td>None</td>
      <td>F</td>
      <td>19366113</td>
      <td>89335</td>
      <td>+36.9315489</td>
      <td>-082.6259960</td>
      <td>POLYGON ((-82.66362 36.92096, -82.66314 36.921...</td>
    </tr>
    <tr>
      <th>2226</th>
      <td>51</td>
      <td>790</td>
      <td>01789075</td>
      <td>51790</td>
      <td>Staunton</td>
      <td>Staunton city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>277</td>
      <td>44420</td>
      <td>None</td>
      <td>F</td>
      <td>51593819</td>
      <td>147694</td>
      <td>+38.1579778</td>
      <td>-079.0618761</td>
      <td>POLYGON ((-79.11382 38.15476, -79.11379 38.154...</td>
    </tr>
    <tr>
      <th>2258</th>
      <td>51</td>
      <td>830</td>
      <td>01789076</td>
      <td>51830</td>
      <td>Williamsburg</td>
      <td>Williamsburg city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>F</td>
      <td>23155310</td>
      <td>416905</td>
      <td>+37.2694810</td>
      <td>-076.7081925</td>
      <td>POLYGON ((-76.74296 37.27542, -76.74296 37.275...</td>
    </tr>
    <tr>
      <th>2367</th>
      <td>51</td>
      <td>163</td>
      <td>01480166</td>
      <td>51163</td>
      <td>Rockbridge</td>
      <td>Rockbridge County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>A</td>
      <td>1545038073</td>
      <td>8836972</td>
      <td>+37.8145174</td>
      <td>-079.4477537</td>
      <td>POLYGON ((-79.60968 37.86430, -79.60982 37.864...</td>
    </tr>
    <tr>
      <th>2453</th>
      <td>51</td>
      <td>690</td>
      <td>01789072</td>
      <td>51690</td>
      <td>Martinsville</td>
      <td>Martinsville city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>32300</td>
      <td>None</td>
      <td>F</td>
      <td>28376610</td>
      <td>133615</td>
      <td>+36.6835269</td>
      <td>-079.8636475</td>
      <td>POLYGON ((-79.90366 36.68464, -79.90289 36.685...</td>
    </tr>
    <tr>
      <th>2485</th>
      <td>51</td>
      <td>195</td>
      <td>01496656</td>
      <td>51195</td>
      <td>Wise</td>
      <td>Wise County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>13720</td>
      <td>None</td>
      <td>A</td>
      <td>1044903124</td>
      <td>5257728</td>
      <td>+36.9745607</td>
      <td>-082.6215601</td>
      <td>POLYGON ((-82.83556 36.84797, -82.83567 36.848...</td>
    </tr>
    <tr>
      <th>2548</th>
      <td>51</td>
      <td>630</td>
      <td>01498425</td>
      <td>51630</td>
      <td>Fredericksburg</td>
      <td>Fredericksburg city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>F</td>
      <td>27067167</td>
      <td>177679</td>
      <td>+38.2992718</td>
      <td>-077.4866583</td>
      <td>POLYGON ((-77.53268 38.30850, -77.53267 38.308...</td>
    </tr>
    <tr>
      <th>2650</th>
      <td>51</td>
      <td>640</td>
      <td>01498426</td>
      <td>51640</td>
      <td>Galax</td>
      <td>Galax city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>F</td>
      <td>21332076</td>
      <td>105290</td>
      <td>+36.6656397</td>
      <td>-080.9143083</td>
      <td>POLYGON ((-80.94982 36.65901, -80.94970 36.661...</td>
    </tr>
    <tr>
      <th>2727</th>
      <td>51</td>
      <td>031</td>
      <td>01674917</td>
      <td>51031</td>
      <td>Campbell</td>
      <td>Campbell County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>31340</td>
      <td>None</td>
      <td>A</td>
      <td>1303300941</td>
      <td>8894442</td>
      <td>+37.2101515</td>
      <td>-079.0954282</td>
      <td>POLYGON ((-79.30244 37.28438, -79.30220 37.284...</td>
    </tr>
    <tr>
      <th>2746</th>
      <td>51</td>
      <td>680</td>
      <td>01498429</td>
      <td>51680</td>
      <td>Lynchburg</td>
      <td>Lynchburg city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>31340</td>
      <td>None</td>
      <td>F</td>
      <td>126842532</td>
      <td>1428787</td>
      <td>+37.3990161</td>
      <td>-079.1954582</td>
      <td>POLYGON ((-79.27139 37.43670, -79.27091 37.437...</td>
    </tr>
    <tr>
      <th>2825</th>
      <td>51</td>
      <td>730</td>
      <td>01498435</td>
      <td>51730</td>
      <td>Petersburg</td>
      <td>Petersburg city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>40060</td>
      <td>None</td>
      <td>F</td>
      <td>58845276</td>
      <td>578133</td>
      <td>+37.2047302</td>
      <td>-077.3923681</td>
      <td>POLYGON ((-77.45492 37.18762, -77.45337 37.188...</td>
    </tr>
    <tr>
      <th>2834</th>
      <td>51</td>
      <td>175</td>
      <td>01480171</td>
      <td>51175</td>
      <td>Southampton</td>
      <td>Southampton County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>A</td>
      <td>1551909771</td>
      <td>8090234</td>
      <td>+36.7200678</td>
      <td>-077.1038135</td>
      <td>POLYGON ((-77.48187 36.68079, -77.48088 36.681...</td>
    </tr>
    <tr>
      <th>2856</th>
      <td>51</td>
      <td>059</td>
      <td>01480119</td>
      <td>51059</td>
      <td>Fairfax</td>
      <td>Fairfax County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>A</td>
      <td>1012703532</td>
      <td>40107717</td>
      <td>+38.8295203</td>
      <td>-077.2732524</td>
      <td>MULTIPOLYGON (((-77.43220 38.95267, -77.43177 ...</td>
    </tr>
    <tr>
      <th>2966</th>
      <td>51</td>
      <td>199</td>
      <td>01480182</td>
      <td>51199</td>
      <td>York</td>
      <td>York County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>A</td>
      <td>270935371</td>
      <td>285552364</td>
      <td>+37.2190813</td>
      <td>-076.5616481</td>
      <td>POLYGON ((-76.56519 37.22054, -76.56521 37.220...</td>
    </tr>
    <tr>
      <th>2975</th>
      <td>51</td>
      <td>165</td>
      <td>01488970</td>
      <td>51165</td>
      <td>Rockingham</td>
      <td>Rockingham County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>277</td>
      <td>25500</td>
      <td>None</td>
      <td>A</td>
      <td>2200943610</td>
      <td>10647709</td>
      <td>+38.5075848</td>
      <td>-078.8853213</td>
      <td>POLYGON ((-79.13112 38.65120, -79.13116 38.651...</td>
    </tr>
    <tr>
      <th>2994</th>
      <td>51</td>
      <td>683</td>
      <td>01498430</td>
      <td>51683</td>
      <td>Manassas</td>
      <td>Manassas city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>F</td>
      <td>25509473</td>
      <td>146287</td>
      <td>+38.7468077</td>
      <td>-077.4826328</td>
      <td>POLYGON ((-77.52666 38.73320, -77.52650 38.733...</td>
    </tr>
    <tr>
      <th>3019</th>
      <td>51</td>
      <td>177</td>
      <td>01480172</td>
      <td>51177</td>
      <td>Spotsylvania</td>
      <td>Spotsylvania County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>47900</td>
      <td>47894</td>
      <td>A</td>
      <td>1039889019</td>
      <td>33115177</td>
      <td>+38.1824314</td>
      <td>-077.6572264</td>
      <td>POLYGON ((-77.78589 38.26993, -77.78357 38.271...</td>
    </tr>
    <tr>
      <th>3065</th>
      <td>51</td>
      <td>149</td>
      <td>01480160</td>
      <td>51149</td>
      <td>Prince George</td>
      <td>Prince George County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>40060</td>
      <td>None</td>
      <td>A</td>
      <td>687232237</td>
      <td>42745198</td>
      <td>+37.1873255</td>
      <td>-077.2209931</td>
      <td>POLYGON ((-77.35170 37.22425, -77.35178 37.224...</td>
    </tr>
    <tr>
      <th>3097</th>
      <td>51</td>
      <td>069</td>
      <td>01480124</td>
      <td>51069</td>
      <td>Frederick</td>
      <td>Frederick County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>49020</td>
      <td>None</td>
      <td>A</td>
      <td>1070102010</td>
      <td>5935110</td>
      <td>+39.2036601</td>
      <td>-078.2638291</td>
      <td>POLYGON ((-78.42771 39.18597, -78.42786 39.186...</td>
    </tr>
    <tr>
      <th>3172</th>
      <td>51</td>
      <td>570</td>
      <td>01498420</td>
      <td>51570</td>
      <td>Colonial Heights</td>
      <td>Colonial Heights city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>40060</td>
      <td>None</td>
      <td>F</td>
      <td>19475232</td>
      <td>766910</td>
      <td>+37.2616846</td>
      <td>-077.3968043</td>
      <td>POLYGON ((-77.43180 37.27560, -77.43180 37.275...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#names = missing_gdf.NAME</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">missing_gdf</span><span class="o">.</span><span class="n">NAMELSAD</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_income</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">GeoName</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;, VA&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_income</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(315, 59)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_income</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>GeoFIPS</th>
      <th>GeoName</th>
      <th>Region</th>
      <th>TableName</th>
      <th>LineCode</th>
      <th>IndustryClassification</th>
      <th>Description</th>
      <th>Unit</th>
      <th>1969</th>
      <th>...</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>GEOID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>8673</td>
      <td>51001</td>
      <td>Accomack, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>1</td>
      <td>...</td>
      <td>Personal income (thousands of dollars)</td>
      <td>Thousands of dollars</td>
      <td>72875</td>
      <td>...</td>
      <td>1089574</td>
      <td>1112288</td>
      <td>1129193</td>
      <td>1181700</td>
      <td>1188926</td>
      <td>1227111</td>
      <td>1277179</td>
      <td>1283155</td>
      <td>1324623</td>
      <td>51001</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8674</td>
      <td>51001</td>
      <td>Accomack, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>2</td>
      <td>...</td>
      <td>Population (persons) 1/</td>
      <td>Number of persons</td>
      <td>29308</td>
      <td>...</td>
      <td>33415</td>
      <td>33147</td>
      <td>33222</td>
      <td>33264</td>
      <td>32963</td>
      <td>32965</td>
      <td>32911</td>
      <td>32818</td>
      <td>32545</td>
      <td>51001</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8675</td>
      <td>51001</td>
      <td>Accomack, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>3</td>
      <td>...</td>
      <td>Per capita personal income (dollars) 2/</td>
      <td>Dollars</td>
      <td>2487</td>
      <td>...</td>
      <td>32607</td>
      <td>33556</td>
      <td>33989</td>
      <td>35525</td>
      <td>36069</td>
      <td>37225</td>
      <td>38807</td>
      <td>39099</td>
      <td>40701</td>
      <td>51001</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8676</td>
      <td>51007</td>
      <td>Amelia, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>1</td>
      <td>...</td>
      <td>Personal income (thousands of dollars)</td>
      <td>Thousands of dollars</td>
      <td>18123</td>
      <td>...</td>
      <td>403821</td>
      <td>427150</td>
      <td>437215</td>
      <td>459614</td>
      <td>493801</td>
      <td>509705</td>
      <td>535479</td>
      <td>538046</td>
      <td>560273</td>
      <td>51007</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8677</td>
      <td>51007</td>
      <td>Amelia, VA</td>
      <td>5</td>
      <td>CAINC1</td>
      <td>2</td>
      <td>...</td>
      <td>Population (persons) 1/</td>
      <td>Number of persons</td>
      <td>7702</td>
      <td>...</td>
      <td>12594</td>
      <td>12746</td>
      <td>12752</td>
      <td>12747</td>
      <td>12659</td>
      <td>12717</td>
      <td>12784</td>
      <td>12830</td>
      <td>13020</td>
      <td>51007</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 59 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geonames</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">virginia_income</span><span class="o">.</span><span class="n">GeoName</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geonames</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Accomack, VA&#39;, &#39;Amelia, VA&#39;, &#39;Amherst, VA&#39;, &#39;Appomattox, VA&#39;,
       &#39;Arlington, VA&#39;, &#39;Bath, VA&#39;, &#39;Bedford, VA*&#39;, &#39;Bland, VA&#39;,
       &#39;Botetourt, VA&#39;, &#39;Brunswick, VA&#39;, &#39;Buchanan, VA&#39;, &#39;Buckingham, VA&#39;,
       &#39;Caroline, VA&#39;, &#39;Charles City, VA&#39;, &#39;Charlotte, VA&#39;,
       &#39;Chesterfield, VA&#39;, &#39;Clarke, VA&#39;, &#39;Craig, VA&#39;, &#39;Culpeper, VA&#39;,
       &#39;Cumberland, VA&#39;, &#39;Dickenson, VA&#39;, &#39;Essex, VA&#39;, &#39;Fauquier, VA&#39;,
       &#39;Floyd, VA&#39;, &#39;Fluvanna, VA&#39;, &#39;Franklin, VA&#39;, &#39;Giles, VA&#39;,
       &#39;Gloucester, VA&#39;, &#39;Goochland, VA&#39;, &#39;Grayson, VA&#39;, &#39;Greene, VA&#39;,
       &#39;Halifax, VA&#39;, &#39;Hanover, VA&#39;, &#39;Henrico, VA&#39;, &#39;Highland, VA&#39;,
       &#39;Isle of Wight, VA&#39;, &#39;King and Queen, VA&#39;, &#39;King George, VA&#39;,
       &#39;King William, VA&#39;, &#39;Lancaster, VA&#39;, &#39;Lee, VA&#39;, &#39;Loudoun, VA&#39;,
       &#39;Louisa, VA&#39;, &#39;Lunenburg, VA&#39;, &#39;Madison, VA&#39;, &#39;Mathews, VA&#39;,
       &#39;Mecklenburg, VA&#39;, &#39;Middlesex, VA&#39;, &#39;Nelson, VA&#39;, &#39;New Kent, VA&#39;,
       &#39;Northampton, VA&#39;, &#39;Northumberland, VA&#39;, &#39;Nottoway, VA&#39;,
       &#39;Orange, VA&#39;, &#39;Page, VA&#39;, &#39;Patrick, VA&#39;, &#39;Powhatan, VA&#39;,
       &#39;Prince Edward, VA&#39;, &#39;Pulaski, VA&#39;, &#39;Rappahannock, VA&#39;,
       &#39;Richmond, VA&#39;, &#39;Russell, VA&#39;, &#39;Scott, VA&#39;, &#39;Shenandoah, VA&#39;,
       &#39;Smyth, VA&#39;, &#39;Stafford, VA&#39;, &#39;Surry, VA&#39;, &#39;Sussex, VA&#39;,
       &#39;Tazewell, VA&#39;, &#39;Warren, VA&#39;, &#39;Westmoreland, VA&#39;, &#39;Wythe, VA&#39;,
       &#39;Alexandria (Independent City), VA&#39;,
       &#39;Chesapeake (Independent City), VA&#39;,
       &#39;Hampton (Independent City), VA&#39;,
       &#39;Newport News (Independent City), VA&#39;,
       &#39;Norfolk (Independent City), VA&#39;,
       &#39;Portsmouth (Independent City), VA&#39;,
       &#39;Richmond (Independent City), VA&#39;,
       &#39;Roanoke (Independent City), VA&#39;, &#39;Suffolk (Independent City), VA&#39;,
       &#39;Virginia Beach (Independent City), VA&#39;,
       &#39;Albemarle + Charlottesville, VA*&#39;, &#39;Alleghany + Covington, VA*&#39;,
       &#39;Augusta, Staunton + Waynesboro, VA*&#39;, &#39;Campbell + Lynchburg, VA*&#39;,
       &#39;Carroll + Galax, VA*&#39;,
       &#39;Dinwiddie, Colonial Heights + Petersburg, VA*&#39;,
       &#39;Fairfax, Fairfax City + Falls Church, VA*&#39;,
       &#39;Frederick + Winchester, VA*&#39;, &#39;Greensville + Emporia, VA*&#39;,
       &#39;Henry + Martinsville, VA*&#39;, &#39;James City + Williamsburg, VA*&#39;,
       &#39;Montgomery + Radford, VA*&#39;, &#39;Pittsylvania + Danville, VA*&#39;,
       &#39;Prince George + Hopewell, VA*&#39;,
       &#39;Prince William, Manassas + Manassas Park, VA*&#39;,
       &#39;Roanoke + Salem, VA*&#39;, &#39;Rockbridge, Buena Vista + Lexington, VA*&#39;,
       &#39;Rockingham + Harrisonburg, VA*&#39;, &#39;Southampton + Franklin, VA*&#39;,
       &#39;Spotsylvania + Fredericksburg, VA*&#39;, &#39;Washington + Bristol, VA*&#39;,
       &#39;Wise + Norton, VA*&#39;, &#39;York + Poquoson, VA*&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Combination</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="n">n_commas</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_commas</span> <span class="o">=</span> <span class="n">n_commas</span>
        <span class="k">if</span> <span class="s2">&quot;Fairfax City&quot;</span> <span class="ow">in</span> <span class="n">label</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Fairfax City&#39;</span><span class="p">,</span> <span class="s1">&#39;Fairfax&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_commas</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;Bedford&quot;</span> <span class="ow">in</span> <span class="n">label</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;Bedford&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cities</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">words</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
                <span class="n">county</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">county</span> <span class="o">=</span> <span class="n">county</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cities</span> <span class="o">=</span> <span class="p">[</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; city&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">n_commas</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">county</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">cities</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">cities</span> <span class="o">=</span> <span class="n">cities</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">cities</span> <span class="o">=</span> <span class="p">[</span><span class="n">city</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; city&quot;</span> <span class="k">for</span> <span class="n">city</span> <span class="ow">in</span> <span class="n">cities</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bad label: &#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">county</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">county</span> <span class="o">+</span> <span class="s2">&quot; County&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">NAMELSAD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span>
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combinations_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">geonames</span> <span class="k">if</span> <span class="s2">&quot;VA*&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>
<span class="n">combinations</span> <span class="o">=</span> <span class="p">[</span><span class="n">Combination</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">combinations_0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c0</span> <span class="o">=</span> <span class="n">combinations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">c0</span><span class="o">.</span><span class="n">label</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Bedford, VA*&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matches</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="n">hits</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">matches</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="s2">&quot;city&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">hits</span> <span class="o">=</span> <span class="p">[</span><span class="n">comb</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">combinations</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">comb</span><span class="o">.</span><span class="n">cities</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hits</span> <span class="o">=</span> <span class="p">[</span><span class="n">comb</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">combinations</span> <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">comb</span><span class="o">.</span><span class="n">county</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">hits</span><span class="p">:</span>
        <span class="n">matches</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span>
    
        
        
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="match-combinations-to-rows-of-df">
<h1>Match combinations to rows of df<a class="headerlink" href="#match-combinations-to-rows-of-df" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;label: &quot;</span><span class="p">,</span><span class="n">combination</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
    <span class="n">comb_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">combination</span><span class="o">.</span><span class="n">county</span><span class="p">]</span><span class="o">+</span><span class="n">combination</span><span class="o">.</span><span class="n">cities</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">comb_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>label:  Bedford, VA*
[&#39;Bedford County&#39;]
label:  Albemarle + Charlottesville, VA*
[&#39;Albemarle County&#39;, &#39;Charlottesville city&#39;]
label:  Alleghany + Covington, VA*
[&#39;Alleghany County&#39;, &#39;Covington city&#39;]
label:  Augusta, Staunton + Waynesboro, VA*
[&#39;Augusta County&#39;, &#39;Staunton city&#39;, &#39;Waynesboro city&#39;]
label:  Campbell + Lynchburg, VA*
[&#39;Campbell County&#39;, &#39;Lynchburg city&#39;]
label:  Carroll + Galax, VA*
[&#39;Carroll County&#39;, &#39;Galax city&#39;]
label:  Dinwiddie, Colonial Heights + Petersburg, VA*
[&#39;Dinwiddie County&#39;, &#39;Colonial Heights city&#39;, &#39;Petersburg city&#39;]
label:  Fairfax, Fairfax City + Falls Church, VA*
[&#39;Fairfax County&#39;, &#39;Fairfax city&#39;, &#39;Falls Church city&#39;]
label:  Frederick + Winchester, VA*
[&#39;Frederick County&#39;, &#39;Winchester city&#39;]
label:  Greensville + Emporia, VA*
[&#39;Greensville County&#39;, &#39;Emporia city&#39;]
label:  Henry + Martinsville, VA*
[&#39;Henry County&#39;, &#39;Martinsville city&#39;]
label:  James City + Williamsburg, VA*
[&#39;James City County&#39;, &#39;Williamsburg city&#39;]
label:  Montgomery + Radford, VA*
[&#39;Montgomery County&#39;, &#39;Radford city&#39;]
label:  Pittsylvania + Danville, VA*
[&#39;Pittsylvania County&#39;, &#39;Danville city&#39;]
label:  Prince George + Hopewell, VA*
[&#39;Prince George County&#39;, &#39;Hopewell city&#39;]
label:  Prince William, Manassas + Manassas Park, VA*
[&#39;Prince William County&#39;, &#39;Manassas city&#39;, &#39;Manassas Park city&#39;]
label:  Roanoke + Salem, VA*
[&#39;Roanoke County&#39;, &#39;Salem city&#39;]
label:  Rockbridge, Buena Vista + Lexington, VA*
[&#39;Rockbridge County&#39;, &#39;Buena Vista city&#39;, &#39;Lexington city&#39;]
label:  Rockingham + Harrisonburg, VA*
[&#39;Rockingham County&#39;, &#39;Harrisonburg city&#39;]
label:  Southampton + Franklin, VA*
[&#39;Southampton County&#39;, &#39;Franklin city&#39;]
label:  Spotsylvania + Fredericksburg, VA*
[&#39;Spotsylvania County&#39;, &#39;Fredericksburg city&#39;]
label:  Washington + Bristol, VA*
[&#39;Washington County&#39;, &#39;Bristol city&#39;]
label:  Wise + Norton, VA*
[&#39;Wise County&#39;, &#39;Norton city&#39;]
label:  York + Poquoson, VA*
[&#39;York County&#39;, &#39;Poquoson city&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">geoids</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">:</span>
    <span class="n">places</span> <span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">cities</span> <span class="o">+</span> <span class="p">[</span><span class="n">combination</span><span class="o">.</span><span class="n">county</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">places</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">virginia_gdf</span><span class="p">[</span><span class="n">virginia_gdf</span><span class="o">.</span><span class="n">NAMELSAD</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">places</span><span class="p">)]</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">places</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;missed:&#39;</span><span class="p">,</span> <span class="n">places</span><span class="p">)</span>
    <span class="c1">#d_df = rows.dissolve(by=&#39;STATEFP&#39;)</span>
    <span class="n">rd</span> <span class="o">=</span> <span class="n">rows</span><span class="o">.</span><span class="n">dissolve</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;STATEFP&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
    <span class="n">rd</span><span class="p">[</span><span class="s1">&#39;NAMELSAD&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">combination</span><span class="o">.</span><span class="n">label</span>
    <span class="n">geoid</span> <span class="o">=</span> <span class="n">virginia_income</span><span class="p">[</span><span class="n">virginia_income</span><span class="o">.</span><span class="n">GeoName</span><span class="o">==</span><span class="n">combination</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">GEOID</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rd</span><span class="p">[</span><span class="s1">&#39;GEOID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geoid</span>
    <span class="n">merged_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Bedford County&#39;]
[&#39;Charlottesville city&#39;, &#39;Albemarle County&#39;]
[&#39;Covington city&#39;, &#39;Alleghany County&#39;]
[&#39;Staunton city&#39;, &#39;Waynesboro city&#39;, &#39;Augusta County&#39;]
[&#39;Lynchburg city&#39;, &#39;Campbell County&#39;]
[&#39;Galax city&#39;, &#39;Carroll County&#39;]
[&#39;Colonial Heights city&#39;, &#39;Petersburg city&#39;, &#39;Dinwiddie County&#39;]
[&#39;Fairfax city&#39;, &#39;Falls Church city&#39;, &#39;Fairfax County&#39;]
[&#39;Winchester city&#39;, &#39;Frederick County&#39;]
[&#39;Emporia city&#39;, &#39;Greensville County&#39;]
[&#39;Martinsville city&#39;, &#39;Henry County&#39;]
[&#39;Williamsburg city&#39;, &#39;James City County&#39;]
[&#39;Radford city&#39;, &#39;Montgomery County&#39;]
[&#39;Danville city&#39;, &#39;Pittsylvania County&#39;]
[&#39;Hopewell city&#39;, &#39;Prince George County&#39;]
[&#39;Manassas city&#39;, &#39;Manassas Park city&#39;, &#39;Prince William County&#39;]
[&#39;Salem city&#39;, &#39;Roanoke County&#39;]
[&#39;Buena Vista city&#39;, &#39;Lexington city&#39;, &#39;Rockbridge County&#39;]
[&#39;Harrisonburg city&#39;, &#39;Rockingham County&#39;]
[&#39;Franklin city&#39;, &#39;Southampton County&#39;]
[&#39;Fredericksburg city&#39;, &#39;Spotsylvania County&#39;]
[&#39;Bristol city&#39;, &#39;Washington County&#39;]
[&#39;Norton city&#39;, &#39;Wise County&#39;]
[&#39;Poquoson city&#39;, &#39;York County&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>CBSAFP</th>
      <th>METDIVFP</th>
      <th>FUNCSTAT</th>
      <th>ALAND</th>
      <th>AWATER</th>
      <th>INTPTLAT</th>
      <th>INTPTLON</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>51</td>
      <td>735</td>
      <td>01498436</td>
      <td>51735</td>
      <td>Poquoson</td>
      <td>Poquoson city</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>F</td>
      <td>39837595</td>
      <td>163455830</td>
      <td>+37.1283599</td>
      <td>-076.3035337</td>
      <td>POLYGON ((-76.41367 37.13862, -76.41338 37.139...</td>
    </tr>
    <tr>
      <th>2966</th>
      <td>51</td>
      <td>199</td>
      <td>01480182</td>
      <td>51199</td>
      <td>York</td>
      <td>York County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>A</td>
      <td>270935371</td>
      <td>285552364</td>
      <td>+37.2190813</td>
      <td>-076.5616481</td>
      <td>POLYGON ((-76.56519 37.22054, -76.56521 37.220...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>CBSAFP</th>
      <th>METDIVFP</th>
      <th>FUNCSTAT</th>
      <th>ALAND</th>
      <th>AWATER</th>
      <th>INTPTLAT</th>
      <th>INTPTLON</th>
    </tr>
    <tr>
      <th>STATEFP</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>51</th>
      <td>POLYGON ((-76.13552 37.19197, -76.13527 37.158...</td>
      <td>735</td>
      <td>01498436</td>
      <td>51958</td>
      <td>Poquoson</td>
      <td>York + Poquoson, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>47260</td>
      <td>None</td>
      <td>F</td>
      <td>39837595</td>
      <td>163455830</td>
      <td>+37.1283599</td>
      <td>-076.3035337</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dissolved</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">merged_dfs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dissolved</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>CBSAFP</th>
      <th>METDIVFP</th>
      <th>FUNCSTAT</th>
      <th>ALAND</th>
      <th>AWATER</th>
      <th>INTPTLAT</th>
      <th>INTPTLON</th>
    </tr>
    <tr>
      <th>STATEFP</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>51</th>
      <td>POLYGON ((-79.63421 37.45702, -79.63409 37.456...</td>
      <td>019</td>
      <td>01674818</td>
      <td>51019</td>
      <td>Bedford</td>
      <td>Bedford, VA*</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>31340</td>
      <td>None</td>
      <td>A</td>
      <td>1968605128</td>
      <td>42118517</td>
      <td>+37.3122568</td>
      <td>-079.5272234</td>
    </tr>
    <tr>
      <th>51</th>
      <td>POLYGON ((-78.80140 37.98263, -78.80241 37.984...</td>
      <td>540</td>
      <td>01789068</td>
      <td>51901</td>
      <td>Charlottesville</td>
      <td>Albemarle + Charlottesville, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>16820</td>
      <td>None</td>
      <td>F</td>
      <td>26533570</td>
      <td>47161</td>
      <td>+38.0376579</td>
      <td>-078.4853806</td>
    </tr>
    <tr>
      <th>51</th>
      <td>POLYGON ((-80.20146 37.82581, -80.20117 37.826...</td>
      <td>580</td>
      <td>01789069</td>
      <td>51903</td>
      <td>Covington</td>
      <td>Alleghany + Covington, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>F</td>
      <td>14163842</td>
      <td>521492</td>
      <td>+37.7810603</td>
      <td>-079.9854337</td>
    </tr>
    <tr>
      <th>51</th>
      <td>POLYGON ((-79.36786 38.01803, -79.37404 38.021...</td>
      <td>820</td>
      <td>01498443</td>
      <td>51907</td>
      <td>Waynesboro</td>
      <td>Augusta, Staunton + Waynesboro, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>277</td>
      <td>44420</td>
      <td>None</td>
      <td>F</td>
      <td>38771594</td>
      <td>364644</td>
      <td>+38.0671571</td>
      <td>-078.9014197</td>
    </tr>
    <tr>
      <th>51</th>
      <td>POLYGON ((-79.30244 37.28438, -79.30220 37.284...</td>
      <td>031</td>
      <td>01674917</td>
      <td>51911</td>
      <td>Campbell</td>
      <td>Campbell + Lynchburg, VA*</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>31340</td>
      <td>None</td>
      <td>A</td>
      <td>1303300941</td>
      <td>8894442</td>
      <td>+37.2101515</td>
      <td>-079.0954282</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_merge</span> <span class="o">=</span> <span class="n">dissolved</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">virginia_income</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;GEOID&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_merge</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POLYGON ((-79.63421 37.45702, -79.63409 37.456...</td>
      <td>019</td>
      <td>01674818</td>
      <td>51019</td>
      <td>Bedford</td>
      <td>Bedford, VA*</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>2696045</td>
      <td>2678191</td>
      <td>2715575</td>
      <td>2838513</td>
      <td>2973578</td>
      <td>3001522</td>
      <td>3129081</td>
      <td>3297923</td>
      <td>3311202</td>
      <td>3417264</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POLYGON ((-79.63421 37.45702, -79.63409 37.456...</td>
      <td>019</td>
      <td>01674818</td>
      <td>51019</td>
      <td>Bedford</td>
      <td>Bedford, VA*</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>73744</td>
      <td>74573</td>
      <td>75040</td>
      <td>75560</td>
      <td>75758</td>
      <td>76195</td>
      <td>77035</td>
      <td>77562</td>
      <td>77828</td>
      <td>77974</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POLYGON ((-79.63421 37.45702, -79.63409 37.456...</td>
      <td>019</td>
      <td>01674818</td>
      <td>51019</td>
      <td>Bedford</td>
      <td>Bedford, VA*</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>36560</td>
      <td>35914</td>
      <td>36188</td>
      <td>37566</td>
      <td>39251</td>
      <td>39393</td>
      <td>40619</td>
      <td>42520</td>
      <td>42545</td>
      <td>43826</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POLYGON ((-78.80140 37.98263, -78.80241 37.984...</td>
      <td>540</td>
      <td>01789068</td>
      <td>51901</td>
      <td>Charlottesville</td>
      <td>Albemarle + Charlottesville, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>7188821</td>
      <td>6825990</td>
      <td>7209179</td>
      <td>7623402</td>
      <td>8402062</td>
      <td>8270217</td>
      <td>8881388</td>
      <td>9494461</td>
      <td>9981222</td>
      <td>10531351</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POLYGON ((-78.80140 37.98263, -78.80241 37.984...</td>
      <td>540</td>
      <td>01789068</td>
      <td>51901</td>
      <td>Charlottesville</td>
      <td>Albemarle + Charlottesville, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>139211</td>
      <td>141125</td>
      <td>142703</td>
      <td>144094</td>
      <td>146077</td>
      <td>147430</td>
      <td>149410</td>
      <td>151694</td>
      <td>153705</td>
      <td>155721</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 75 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_merge</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(72, 75)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_merge</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_48_1.png" src="../../_images/020_virginia_48_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_49_1.png" src="../../_images/020_virginia_49_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">merged_gdf</span><span class="p">,</span> <span class="n">d_merge</span><span class="p">])</span>
<span class="n">final_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_50_1.png" src="../../_images/020_virginia_50_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(318, 76)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_gdf</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(133, 18)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>5598667</td>
      <td>5771841</td>
      <td>6051523</td>
      <td>6377898</td>
      <td>6564332</td>
      <td>6618516</td>
      <td>6806720</td>
      <td>7145523</td>
      <td>7413434</td>
      <td>7779485</td>
    </tr>
    <tr>
      <th>1</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>124323</td>
      <td>126449</td>
      <td>129822</td>
      <td>132207</td>
      <td>133376</td>
      <td>135978</td>
      <td>138802</td>
      <td>140891</td>
      <td>143477</td>
      <td>146649</td>
    </tr>
    <tr>
      <th>2</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>45033</td>
      <td>45646</td>
      <td>46614</td>
      <td>48242</td>
      <td>49217</td>
      <td>48673</td>
      <td>49039</td>
      <td>50717</td>
      <td>51670</td>
      <td>53048</td>
    </tr>
    <tr>
      <th>3</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>236619</td>
      <td>237659</td>
      <td>235027</td>
      <td>241403</td>
      <td>244447</td>
      <td>243534</td>
      <td>255985</td>
      <td>274412</td>
      <td>263711</td>
      <td>277471</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>7061</td>
      <td>7037</td>
      <td>7045</td>
      <td>6923</td>
      <td>6839</td>
      <td>6788</td>
      <td>6781</td>
      <td>6670</td>
      <td>6570</td>
      <td>6540</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>67</th>
      <td>NaN</td>
      <td>720</td>
      <td>01498434</td>
      <td>51955</td>
      <td>Norton</td>
      <td>Wise + Norton, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>45350</td>
      <td>45357</td>
      <td>45583</td>
      <td>45535</td>
      <td>45034</td>
      <td>44764</td>
      <td>44036</td>
      <td>43567</td>
      <td>43022</td>
      <td>42522</td>
    </tr>
    <tr>
      <th>68</th>
      <td>NaN</td>
      <td>720</td>
      <td>01498434</td>
      <td>51955</td>
      <td>Norton</td>
      <td>Wise + Norton, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>27531</td>
      <td>28516</td>
      <td>30485</td>
      <td>31511</td>
      <td>30802</td>
      <td>29494</td>
      <td>30164</td>
      <td>30893</td>
      <td>30533</td>
      <td>31849</td>
    </tr>
    <tr>
      <th>69</th>
      <td>NaN</td>
      <td>735</td>
      <td>01498436</td>
      <td>51958</td>
      <td>Poquoson</td>
      <td>York + Poquoson, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>...</td>
      <td>3686780</td>
      <td>3620374</td>
      <td>3738324</td>
      <td>3869473</td>
      <td>3974745</td>
      <td>4005287</td>
      <td>4201387</td>
      <td>4325492</td>
      <td>4378441</td>
      <td>4529273</td>
    </tr>
    <tr>
      <th>70</th>
      <td>NaN</td>
      <td>735</td>
      <td>01498436</td>
      <td>51958</td>
      <td>Poquoson</td>
      <td>York + Poquoson, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>...</td>
      <td>77047</td>
      <td>77350</td>
      <td>77440</td>
      <td>77900</td>
      <td>78003</td>
      <td>78170</td>
      <td>78605</td>
      <td>79834</td>
      <td>79689</td>
      <td>79792</td>
    </tr>
    <tr>
      <th>71</th>
      <td>NaN</td>
      <td>735</td>
      <td>01498436</td>
      <td>51958</td>
      <td>Poquoson</td>
      <td>York + Poquoson, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>545</td>
      <td>...</td>
      <td>47851</td>
      <td>46805</td>
      <td>48274</td>
      <td>49672</td>
      <td>50956</td>
      <td>51238</td>
      <td>53449</td>
      <td>54181</td>
      <td>54944</td>
      <td>56763</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;1978&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_55_1.png" src="../../_images/020_virginia_55_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="p">[</span><span class="s1">&#39;1979&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_gdf</span><span class="p">[</span><span class="s1">&#39;1979&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;1979&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_57_1.png" src="../../_images/020_virginia_57_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;STATEFP&#39;, &#39;COUNTYFP&#39;, &#39;COUNTYNS&#39;, &#39;GEOID&#39;, &#39;NAME&#39;, &#39;NAMELSAD&#39;, &#39;LSAD&#39;,
       &#39;CLASSFP&#39;, &#39;MTFCC&#39;, &#39;CSAFP&#39;, &#39;CBSAFP&#39;, &#39;METDIVFP&#39;, &#39;FUNCSTAT&#39;, &#39;ALAND&#39;,
       &#39;AWATER&#39;, &#39;INTPTLAT&#39;, &#39;INTPTLON&#39;, &#39;geometry&#39;, &#39;Unnamed: 0&#39;, &#39;GeoFIPS&#39;,
       &#39;GeoName&#39;, &#39;Region&#39;, &#39;TableName&#39;, &#39;LineCode&#39;, &#39;IndustryClassification&#39;,
       &#39;Description&#39;, &#39;Unit&#39;, &#39;1969&#39;, &#39;1970&#39;, &#39;1971&#39;, &#39;1972&#39;, &#39;1973&#39;, &#39;1974&#39;,
       &#39;1975&#39;, &#39;1976&#39;, &#39;1977&#39;, &#39;1978&#39;, &#39;1979&#39;, &#39;1980&#39;, &#39;1981&#39;, &#39;1982&#39;, &#39;1983&#39;,
       &#39;1984&#39;, &#39;1985&#39;, &#39;1986&#39;, &#39;1987&#39;, &#39;1988&#39;, &#39;1989&#39;, &#39;1990&#39;, &#39;1991&#39;, &#39;1992&#39;,
       &#39;1993&#39;, &#39;1994&#39;, &#39;1995&#39;, &#39;1996&#39;, &#39;1997&#39;, &#39;1998&#39;, &#39;1999&#39;, &#39;2000&#39;, &#39;2001&#39;,
       &#39;2002&#39;, &#39;2003&#39;, &#39;2004&#39;, &#39;2005&#39;, &#39;2006&#39;, &#39;2007&#39;, &#39;2008&#39;, &#39;2009&#39;, &#39;2010&#39;,
       &#39;2011&#39;, &#39;2012&#39;, &#39;2013&#39;, &#39;2014&#39;, &#39;2015&#39;, &#39;2016&#39;, &#39;2017&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>5598667</td>
      <td>5771841</td>
      <td>6051523</td>
      <td>6377898</td>
      <td>6564332</td>
      <td>6618516</td>
      <td>6806720</td>
      <td>7145523</td>
      <td>7413434</td>
      <td>7779485</td>
    </tr>
    <tr>
      <th>1</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>124323</td>
      <td>126449</td>
      <td>129822</td>
      <td>132207</td>
      <td>133376</td>
      <td>135978</td>
      <td>138802</td>
      <td>140891</td>
      <td>143477</td>
      <td>146649</td>
    </tr>
    <tr>
      <th>2</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>45033</td>
      <td>45646</td>
      <td>46614</td>
      <td>48242</td>
      <td>49217</td>
      <td>48673</td>
      <td>49039</td>
      <td>50717</td>
      <td>51670</td>
      <td>53048</td>
    </tr>
    <tr>
      <th>3</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>236619</td>
      <td>237659</td>
      <td>235027</td>
      <td>241403</td>
      <td>244447</td>
      <td>243534</td>
      <td>255985</td>
      <td>274412</td>
      <td>263711</td>
      <td>277471</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>7061</td>
      <td>7037</td>
      <td>7045</td>
      <td>6923</td>
      <td>6839</td>
      <td>6788</td>
      <td>6781</td>
      <td>6670</td>
      <td>6570</td>
      <td>6540</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(318, 76)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">327859</span><span class="o">/</span><span class="mi">37657</span> <span class="o">*</span> <span class="mi">1000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8706.455639057811
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">318</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>106.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="o">=</span><span class="s1">&#39;51&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="p">[</span><span class="n">final_gdf</span><span class="o">.</span><span class="n">NAME</span><span class="o">==</span><span class="s1">&#39;Charlottesville&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>51</td>
      <td>540</td>
      <td>01789068</td>
      <td>51901</td>
      <td>Charlottesville</td>
      <td>Albemarle + Charlottesville, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>7188821</td>
      <td>6825990</td>
      <td>7209179</td>
      <td>7623402</td>
      <td>8402062</td>
      <td>8270217</td>
      <td>8881388</td>
      <td>9494461</td>
      <td>9981222</td>
      <td>10531351</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>540</td>
      <td>01789068</td>
      <td>51901</td>
      <td>Charlottesville</td>
      <td>Albemarle + Charlottesville, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>139211</td>
      <td>141125</td>
      <td>142703</td>
      <td>144094</td>
      <td>146077</td>
      <td>147430</td>
      <td>149410</td>
      <td>151694</td>
      <td>153705</td>
      <td>155721</td>
    </tr>
    <tr>
      <th>5</th>
      <td>51</td>
      <td>540</td>
      <td>01789068</td>
      <td>51901</td>
      <td>Charlottesville</td>
      <td>Albemarle + Charlottesville, VA*</td>
      <td>25</td>
      <td>C7</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>51640</td>
      <td>48368</td>
      <td>50519</td>
      <td>52906</td>
      <td>57518</td>
      <td>56096</td>
      <td>59443</td>
      <td>62590</td>
      <td>64938</td>
      <td>67630</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 76 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">727271</span><span class="o">*</span><span class="mi">1000</span><span class="o">/</span><span class="mi">93879</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7746.8976022326615
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reverse-matching">
<h1>Reverse Matching<a class="headerlink" href="#reverse-matching" title="Permalink to this headline">¶</a></h1>
<p>Which income records do not match a record in the shapefile</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">virginia_gdf</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">STATEFP</span><span class="o">==</span><span class="s2">&quot;51&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data = data[data.LineCode==3]</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">virginia_gdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;GEOID&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(246, 76)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">missing_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">GEOID</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">merged_df</span><span class="o">.</span><span class="n">GEOID</span><span class="p">)]</span>
<span class="c1">#~virginia_gdf.GEOID.isin(merged_gdf.GEOID)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">missing_df</span><span class="o">.</span><span class="n">GeoName</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Albemarle + Charlottesville, VA*&#39;,
 &#39;Alleghany + Covington, VA*&#39;,
 &#39;Augusta, Staunton + Waynesboro, VA*&#39;,
 &#39;Campbell + Lynchburg, VA*&#39;,
 &#39;Carroll + Galax, VA*&#39;,
 &#39;Dinwiddie, Colonial Heights + Petersburg, VA*&#39;,
 &#39;Fairfax, Fairfax City + Falls Church, VA*&#39;,
 &#39;Frederick + Winchester, VA*&#39;,
 &#39;Greensville + Emporia, VA*&#39;,
 &#39;Henry + Martinsville, VA*&#39;,
 &#39;James City + Williamsburg, VA*&#39;,
 &#39;Montgomery + Radford, VA*&#39;,
 &#39;Pittsylvania + Danville, VA*&#39;,
 &#39;Prince George + Hopewell, VA*&#39;,
 &#39;Prince William, Manassas + Manassas Park, VA*&#39;,
 &#39;Roanoke + Salem, VA*&#39;,
 &#39;Rockbridge, Buena Vista + Lexington, VA*&#39;,
 &#39;Rockingham + Harrisonburg, VA*&#39;,
 &#39;Southampton + Franklin, VA*&#39;,
 &#39;Spotsylvania + Fredericksburg, VA*&#39;,
 &#39;Virginia&#39;,
 &#39;Washington + Bristol, VA*&#39;,
 &#39;Wise + Norton, VA*&#39;,
 &#39;York + Poquoson, VA*&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcincome_gdf</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;pcincome0.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcincome_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01</td>
      <td>027</td>
      <td>00161539</td>
      <td>01027</td>
      <td>Clay</td>
      <td>Clay County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>388053</td>
      <td>387623</td>
      <td>365655</td>
      <td>367837</td>
      <td>376622</td>
      <td>395399</td>
      <td>417058</td>
      <td>419915</td>
      <td>444182</td>
      <td>POLYGON ((-85.97879 33.32757, -85.97876 33.328...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>01</td>
      <td>027</td>
      <td>00161539</td>
      <td>01027</td>
      <td>Clay</td>
      <td>Clay County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>14006</td>
      <td>13900</td>
      <td>13688</td>
      <td>13434</td>
      <td>13406</td>
      <td>13440</td>
      <td>13414</td>
      <td>13410</td>
      <td>13367</td>
      <td>POLYGON ((-85.97879 33.32757, -85.97876 33.328...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>01</td>
      <td>027</td>
      <td>00161539</td>
      <td>01027</td>
      <td>Clay</td>
      <td>Clay County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>27706</td>
      <td>27887</td>
      <td>26714</td>
      <td>27381</td>
      <td>28094</td>
      <td>29420</td>
      <td>31091</td>
      <td>31314</td>
      <td>33230</td>
      <td>POLYGON ((-85.97879 33.32757, -85.97876 33.328...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01</td>
      <td>091</td>
      <td>00161572</td>
      <td>01091</td>
      <td>Marengo</td>
      <td>Marengo County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>618986</td>
      <td>643067</td>
      <td>658510</td>
      <td>672442</td>
      <td>682230</td>
      <td>703891</td>
      <td>713222</td>
      <td>717118</td>
      <td>737908</td>
      <td>POLYGON ((-87.92970 32.29252, -87.93180 32.297...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01</td>
      <td>091</td>
      <td>00161572</td>
      <td>01091</td>
      <td>Marengo</td>
      <td>Marengo County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>21170</td>
      <td>20944</td>
      <td>20649</td>
      <td>20360</td>
      <td>20105</td>
      <td>19975</td>
      <td>19757</td>
      <td>19505</td>
      <td>19375</td>
      <td>POLYGON ((-87.92970 32.29252, -87.93180 32.297...</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STATEFP</th>
      <th>COUNTYFP</th>
      <th>COUNTYNS</th>
      <th>GEOID</th>
      <th>NAME</th>
      <th>NAMELSAD</th>
      <th>LSAD</th>
      <th>CLASSFP</th>
      <th>MTFCC</th>
      <th>CSAFP</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>5598667</td>
      <td>5771841</td>
      <td>6051523</td>
      <td>6377898</td>
      <td>6564332</td>
      <td>6618516</td>
      <td>6806720</td>
      <td>7145523</td>
      <td>7413434</td>
      <td>7779485</td>
    </tr>
    <tr>
      <th>1</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>124323</td>
      <td>126449</td>
      <td>129822</td>
      <td>132207</td>
      <td>133376</td>
      <td>135978</td>
      <td>138802</td>
      <td>140891</td>
      <td>143477</td>
      <td>146649</td>
    </tr>
    <tr>
      <th>2</th>
      <td>51</td>
      <td>179</td>
      <td>01480173</td>
      <td>51179</td>
      <td>Stafford</td>
      <td>Stafford County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>548</td>
      <td>...</td>
      <td>45033</td>
      <td>45646</td>
      <td>46614</td>
      <td>48242</td>
      <td>49217</td>
      <td>48673</td>
      <td>49039</td>
      <td>50717</td>
      <td>51670</td>
      <td>53048</td>
    </tr>
    <tr>
      <th>3</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>236619</td>
      <td>237659</td>
      <td>235027</td>
      <td>241403</td>
      <td>244447</td>
      <td>243534</td>
      <td>255985</td>
      <td>274412</td>
      <td>263711</td>
      <td>277471</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>181</td>
      <td>01480174</td>
      <td>51181</td>
      <td>Surry</td>
      <td>Surry County</td>
      <td>06</td>
      <td>H1</td>
      <td>G4020</td>
      <td>None</td>
      <td>...</td>
      <td>7061</td>
      <td>7037</td>
      <td>7045</td>
      <td>6923</td>
      <td>6839</td>
      <td>6788</td>
      <td>6781</td>
      <td>6670</td>
      <td>6570</td>
      <td>6540</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_gdf</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;STATEFP&#39;, &#39;COUNTYFP&#39;, &#39;COUNTYNS&#39;, &#39;GEOID&#39;, &#39;NAME&#39;, &#39;NAMELSAD&#39;, &#39;LSAD&#39;,
       &#39;CLASSFP&#39;, &#39;MTFCC&#39;, &#39;CSAFP&#39;, &#39;CBSAFP&#39;, &#39;METDIVFP&#39;, &#39;FUNCSTAT&#39;, &#39;ALAND&#39;,
       &#39;AWATER&#39;, &#39;INTPTLAT&#39;, &#39;INTPTLON&#39;, &#39;geometry&#39;, &#39;Unnamed: 0&#39;, &#39;GeoFIPS&#39;,
       &#39;GeoName&#39;, &#39;Region&#39;, &#39;TableName&#39;, &#39;LineCode&#39;, &#39;IndustryClassification&#39;,
       &#39;Description&#39;, &#39;Unit&#39;, &#39;1969&#39;, &#39;1970&#39;, &#39;1971&#39;, &#39;1972&#39;, &#39;1973&#39;, &#39;1974&#39;,
       &#39;1975&#39;, &#39;1976&#39;, &#39;1977&#39;, &#39;1978&#39;, &#39;1979&#39;, &#39;1980&#39;, &#39;1981&#39;, &#39;1982&#39;, &#39;1983&#39;,
       &#39;1984&#39;, &#39;1985&#39;, &#39;1986&#39;, &#39;1987&#39;, &#39;1988&#39;, &#39;1989&#39;, &#39;1990&#39;, &#39;1991&#39;, &#39;1992&#39;,
       &#39;1993&#39;, &#39;1994&#39;, &#39;1995&#39;, &#39;1996&#39;, &#39;1997&#39;, &#39;1998&#39;, &#39;1999&#39;, &#39;2000&#39;, &#39;2001&#39;,
       &#39;2002&#39;, &#39;2003&#39;, &#39;2004&#39;, &#39;2005&#39;, &#39;2006&#39;, &#39;2007&#39;, &#39;2008&#39;, &#39;2009&#39;, &#39;2010&#39;,
       &#39;2011&#39;, &#39;2012&#39;, &#39;2013&#39;, &#39;2014&#39;, &#39;2015&#39;, &#39;2016&#39;, &#39;2017&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcincome_gdf</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;STATEFP&#39;, &#39;COUNTYFP&#39;, &#39;COUNTYNS&#39;, &#39;GEOID&#39;, &#39;NAME&#39;, &#39;NAMELSAD&#39;, &#39;LSAD&#39;,
       &#39;CLASSFP&#39;, &#39;MTFCC&#39;, &#39;CSAFP&#39;, &#39;CBSAFP&#39;, &#39;METDIVFP&#39;, &#39;FUNCSTAT&#39;, &#39;ALAND&#39;,
       &#39;AWATER&#39;, &#39;INTPTLAT&#39;, &#39;INTPTLON&#39;, &#39;Unnamed_ 0&#39;, &#39;GeoFIPS&#39;, &#39;GeoName&#39;,
       &#39;Region&#39;, &#39;TableName&#39;, &#39;LineCode&#39;, &#39;IndustryCl&#39;, &#39;Descriptio&#39;, &#39;Unit&#39;,
       &#39;1969&#39;, &#39;1970&#39;, &#39;1971&#39;, &#39;1972&#39;, &#39;1973&#39;, &#39;1974&#39;, &#39;1975&#39;, &#39;1976&#39;, &#39;1977&#39;,
       &#39;1978&#39;, &#39;1979&#39;, &#39;1980&#39;, &#39;1981&#39;, &#39;1982&#39;, &#39;1983&#39;, &#39;1984&#39;, &#39;1985&#39;, &#39;1986&#39;,
       &#39;1987&#39;, &#39;1988&#39;, &#39;1989&#39;, &#39;1990&#39;, &#39;1991&#39;, &#39;1992&#39;, &#39;1993&#39;, &#39;1994&#39;, &#39;1995&#39;,
       &#39;1996&#39;, &#39;1997&#39;, &#39;1998&#39;, &#39;1999&#39;, &#39;2000&#39;, &#39;2001&#39;, &#39;2002&#39;, &#39;2003&#39;, &#39;2004&#39;,
       &#39;2005&#39;, &#39;2006&#39;, &#39;2007&#39;, &#39;2008&#39;, &#39;2009&#39;, &#39;2010&#39;, &#39;2011&#39;, &#39;2012&#39;, &#39;2013&#39;,
       &#39;2014&#39;, &#39;2015&#39;, &#39;2016&#39;, &#39;2017&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pcincome_gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">final_gdf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;1969&#39;,
 &#39;1970&#39;,
 &#39;1971&#39;,
 &#39;1972&#39;,
 &#39;1973&#39;,
 &#39;1974&#39;,
 &#39;1975&#39;,
 &#39;1976&#39;,
 &#39;1977&#39;,
 &#39;1978&#39;,
 &#39;1979&#39;,
 &#39;1980&#39;,
 &#39;1981&#39;,
 &#39;1982&#39;,
 &#39;1983&#39;,
 &#39;1984&#39;,
 &#39;1985&#39;,
 &#39;1986&#39;,
 &#39;1987&#39;,
 &#39;1988&#39;,
 &#39;1989&#39;,
 &#39;1990&#39;,
 &#39;1991&#39;,
 &#39;1992&#39;,
 &#39;1993&#39;,
 &#39;1994&#39;,
 &#39;1995&#39;,
 &#39;1996&#39;,
 &#39;1997&#39;,
 &#39;1998&#39;,
 &#39;1999&#39;,
 &#39;2000&#39;,
 &#39;2001&#39;,
 &#39;2002&#39;,
 &#39;2003&#39;,
 &#39;2004&#39;,
 &#39;2005&#39;,
 &#39;2006&#39;,
 &#39;2007&#39;,
 &#39;2008&#39;,
 &#39;2009&#39;,
 &#39;2010&#39;,
 &#39;2011&#39;,
 &#39;2012&#39;,
 &#39;2013&#39;,
 &#39;2014&#39;,
 &#39;2015&#39;,
 &#39;2016&#39;,
 &#39;2017&#39;,
 &#39;ALAND&#39;,
 &#39;AWATER&#39;,
 &#39;CBSAFP&#39;,
 &#39;CLASSFP&#39;,
 &#39;COUNTYFP&#39;,
 &#39;COUNTYNS&#39;,
 &#39;CSAFP&#39;,
 &#39;FUNCSTAT&#39;,
 &#39;GEOID&#39;,
 &#39;GeoFIPS&#39;,
 &#39;GeoName&#39;,
 &#39;INTPTLAT&#39;,
 &#39;INTPTLON&#39;,
 &#39;LSAD&#39;,
 &#39;LineCode&#39;,
 &#39;METDIVFP&#39;,
 &#39;MTFCC&#39;,
 &#39;NAME&#39;,
 &#39;NAMELSAD&#39;,
 &#39;Region&#39;,
 &#39;STATEFP&#39;,
 &#39;TableName&#39;,
 &#39;Unit&#39;,
 &#39;geometry&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">us</span> <span class="o">=</span> <span class="n">pcincome_gdf</span><span class="p">[</span><span class="n">common</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">va</span> <span class="o">=</span> <span class="n">final_gdf</span><span class="p">[</span><span class="n">common</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">va</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dup</span> <span class="o">=</span> <span class="n">va</span><span class="p">[</span><span class="n">va</span><span class="p">[[</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span> <span class="s2">&quot;GEOID&quot;</span><span class="p">,</span> <span class="s2">&quot;1969&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dup</span><span class="o">.</span><span class="n">NAME</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>246    Bedford
247    Bedford
248    Bedford
Name: NAME, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dup</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>1993</th>
      <th>2007</th>
      <th>1987</th>
      <th>1984</th>
      <th>1973</th>
      <th>1976</th>
      <th>ALAND</th>
      <th>1978</th>
      <th>1974</th>
      <th>...</th>
      <th>2006</th>
      <th>1982</th>
      <th>1983</th>
      <th>2012</th>
      <th>2017</th>
      <th>1985</th>
      <th>2010</th>
      <th>2015</th>
      <th>1980</th>
      <th>CBSAFP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>246</th>
      <td>0</td>
      <td>1132351</td>
      <td>2556202</td>
      <td>697232</td>
      <td>538072</td>
      <td>145128</td>
      <td>203128</td>
      <td>1968605128</td>
      <td>268705</td>
      <td>164214</td>
      <td>...</td>
      <td>2455970</td>
      <td>430347</td>
      <td>477533</td>
      <td>2973578</td>
      <td>3417264</td>
      <td>586035</td>
      <td>2715575</td>
      <td>3297923</td>
      <td>362147</td>
      <td>31340</td>
    </tr>
    <tr>
      <th>247</th>
      <td>1</td>
      <td>57062</td>
      <td>73561</td>
      <td>48013</td>
      <td>44277</td>
      <td>34727</td>
      <td>36657</td>
      <td>1968605128</td>
      <td>39054</td>
      <td>35696</td>
      <td>...</td>
      <td>72510</td>
      <td>42582</td>
      <td>43145</td>
      <td>75758</td>
      <td>77974</td>
      <td>45261</td>
      <td>75040</td>
      <td>77562</td>
      <td>41157</td>
      <td>31340</td>
    </tr>
    <tr>
      <th>248</th>
      <td>2</td>
      <td>19844</td>
      <td>34749</td>
      <td>14522</td>
      <td>12152</td>
      <td>4179</td>
      <td>5541</td>
      <td>1968605128</td>
      <td>6880</td>
      <td>4600</td>
      <td>...</td>
      <td>33871</td>
      <td>10106</td>
      <td>11068</td>
      <td>39251</td>
      <td>43826</td>
      <td>12948</td>
      <td>36188</td>
      <td>42520</td>
      <td>8799</td>
      <td>31340</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 74 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">va</span> <span class="o">=</span> <span class="n">va</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">dup</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">usva</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">us</span><span class="p">,</span><span class="n">va</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">usva</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/020_virginia_87_1.png" src="../../_images/020_virginia_87_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">usva</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9024, 74)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">9027</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3009.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1969</span><span class="p">,</span><span class="mi">2018</span><span class="p">)]</span>
<span class="n">dtypes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,[</span><span class="n">usva</span><span class="p">[</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]))</span>
<span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;1969&#39;, dtype(&#39;O&#39;)),
 (&#39;1970&#39;, dtype(&#39;O&#39;)),
 (&#39;1971&#39;, dtype(&#39;O&#39;)),
 (&#39;1972&#39;, dtype(&#39;O&#39;)),
 (&#39;1973&#39;, dtype(&#39;O&#39;)),
 (&#39;1974&#39;, dtype(&#39;O&#39;)),
 (&#39;1975&#39;, dtype(&#39;O&#39;)),
 (&#39;1976&#39;, dtype(&#39;O&#39;)),
 (&#39;1977&#39;, dtype(&#39;O&#39;)),
 (&#39;1978&#39;, dtype(&#39;O&#39;)),
 (&#39;1979&#39;, dtype(&#39;O&#39;)),
 (&#39;1980&#39;, dtype(&#39;O&#39;)),
 (&#39;1981&#39;, dtype(&#39;O&#39;)),
 (&#39;1982&#39;, dtype(&#39;O&#39;)),
 (&#39;1983&#39;, dtype(&#39;O&#39;)),
 (&#39;1984&#39;, dtype(&#39;O&#39;)),
 (&#39;1985&#39;, dtype(&#39;O&#39;)),
 (&#39;1986&#39;, dtype(&#39;O&#39;)),
 (&#39;1987&#39;, dtype(&#39;O&#39;)),
 (&#39;1988&#39;, dtype(&#39;O&#39;)),
 (&#39;1989&#39;, dtype(&#39;O&#39;)),
 (&#39;1990&#39;, dtype(&#39;O&#39;)),
 (&#39;1991&#39;, dtype(&#39;O&#39;)),
 (&#39;1992&#39;, dtype(&#39;O&#39;)),
 (&#39;1993&#39;, dtype(&#39;O&#39;)),
 (&#39;1994&#39;, dtype(&#39;O&#39;)),
 (&#39;1995&#39;, dtype(&#39;O&#39;)),
 (&#39;1996&#39;, dtype(&#39;O&#39;)),
 (&#39;1997&#39;, dtype(&#39;O&#39;)),
 (&#39;1998&#39;, dtype(&#39;O&#39;)),
 (&#39;1999&#39;, dtype(&#39;O&#39;)),
 (&#39;2000&#39;, dtype(&#39;O&#39;)),
 (&#39;2001&#39;, dtype(&#39;O&#39;)),
 (&#39;2002&#39;, dtype(&#39;int64&#39;)),
 (&#39;2003&#39;, dtype(&#39;int64&#39;)),
 (&#39;2004&#39;, dtype(&#39;int64&#39;)),
 (&#39;2005&#39;, dtype(&#39;int64&#39;)),
 (&#39;2006&#39;, dtype(&#39;int64&#39;)),
 (&#39;2007&#39;, dtype(&#39;int64&#39;)),
 (&#39;2008&#39;, dtype(&#39;int64&#39;)),
 (&#39;2009&#39;, dtype(&#39;int64&#39;)),
 (&#39;2010&#39;, dtype(&#39;int64&#39;)),
 (&#39;2011&#39;, dtype(&#39;int64&#39;)),
 (&#39;2012&#39;, dtype(&#39;int64&#39;)),
 (&#39;2013&#39;, dtype(&#39;int64&#39;)),
 (&#39;2014&#39;, dtype(&#39;int64&#39;)),
 (&#39;2015&#39;, dtype(&#39;int64&#39;)),
 (&#39;2016&#39;, dtype(&#39;int64&#39;)),
 (&#39;2017&#39;, dtype(&#39;int64&#39;))]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">usva</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;usva.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">usva</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1993</th>
      <th>2007</th>
      <th>1987</th>
      <th>1984</th>
      <th>1973</th>
      <th>1976</th>
      <th>ALAND</th>
      <th>1978</th>
      <th>1974</th>
      <th>CLASSFP</th>
      <th>...</th>
      <th>1982</th>
      <th>1983</th>
      <th>2012</th>
      <th>2017</th>
      <th>1985</th>
      <th>2010</th>
      <th>2015</th>
      <th>1980</th>
      <th>CBSAFP</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>220795</td>
      <td>387587</td>
      <td>139903</td>
      <td>121146</td>
      <td>40439</td>
      <td>55169</td>
      <td>1564251834</td>
      <td>72051</td>
      <td>42473</td>
      <td>H1</td>
      <td>...</td>
      <td>112037</td>
      <td>112583</td>
      <td>367837</td>
      <td>444182</td>
      <td>124986</td>
      <td>387623</td>
      <td>417058</td>
      <td>94586</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13518</td>
      <td>14085</td>
      <td>13331</td>
      <td>13667</td>
      <td>12959</td>
      <td>13381</td>
      <td>1564251834</td>
      <td>13697</td>
      <td>13139</td>
      <td>H1</td>
      <td>...</td>
      <td>13765</td>
      <td>13759</td>
      <td>13434</td>
      <td>13367</td>
      <td>13700</td>
      <td>13900</td>
      <td>13414</td>
      <td>13740</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16333</td>
      <td>27518</td>
      <td>10495</td>
      <td>8864</td>
      <td>3121</td>
      <td>4123</td>
      <td>1564251834</td>
      <td>5260</td>
      <td>3233</td>
      <td>H1</td>
      <td>...</td>
      <td>8139</td>
      <td>8182</td>
      <td>27381</td>
      <td>33230</td>
      <td>9123</td>
      <td>27887</td>
      <td>31091</td>
      <td>6884</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>362730</td>
      <td>620527</td>
      <td>247800</td>
      <td>208496</td>
      <td>71939</td>
      <td>105444</td>
      <td>2530140237</td>
      <td>129821</td>
      <td>76954</td>
      <td>H1</td>
      <td>...</td>
      <td>187838</td>
      <td>198611</td>
      <td>672442</td>
      <td>737908</td>
      <td>221133</td>
      <td>643067</td>
      <td>713222</td>
      <td>156277</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23210</td>
      <td>21475</td>
      <td>23818</td>
      <td>24385</td>
      <td>24207</td>
      <td>25201</td>
      <td>2530140237</td>
      <td>25429</td>
      <td>24273</td>
      <td>H1</td>
      <td>...</td>
      <td>24666</td>
      <td>24587</td>
      <td>20360</td>
      <td>19375</td>
      <td>24235</td>
      <td>20944</td>
      <td>19757</td>
      <td>24985</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 74 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">usva</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;1993&#39;, &#39;2007&#39;, &#39;1987&#39;, &#39;1984&#39;, &#39;1973&#39;, &#39;1976&#39;, &#39;ALAND&#39;, &#39;1978&#39;, &#39;1974&#39;,
       &#39;CLASSFP&#39;, &#39;1994&#39;, &#39;STATEFP&#39;, &#39;FUNCSTAT&#39;, &#39;2009&#39;, &#39;1971&#39;, &#39;GEOID&#39;,
       &#39;1992&#39;, &#39;1995&#39;, &#39;1975&#39;, &#39;2000&#39;, &#39;2001&#39;, &#39;INTPTLAT&#39;, &#39;Unit&#39;, &#39;1988&#39;,
       &#39;2003&#39;, &#39;1970&#39;, &#39;MTFCC&#39;, &#39;2013&#39;, &#39;Region&#39;, &#39;GeoFIPS&#39;, &#39;1989&#39;, &#39;1999&#39;,
       &#39;2014&#39;, &#39;INTPTLON&#39;, &#39;TableName&#39;, &#39;2016&#39;, &#39;1996&#39;, &#39;CSAFP&#39;, &#39;2004&#39;,
       &#39;1979&#39;, &#39;METDIVFP&#39;, &#39;1972&#39;, &#39;1977&#39;, &#39;2002&#39;, &#39;1990&#39;, &#39;COUNTYFP&#39;,
       &#39;COUNTYNS&#39;, &#39;1969&#39;, &#39;2005&#39;, &#39;1998&#39;, &#39;1991&#39;, &#39;2008&#39;, &#39;AWATER&#39;,
       &#39;LineCode&#39;, &#39;2011&#39;, &#39;NAME&#39;, &#39;1986&#39;, &#39;LSAD&#39;, &#39;GeoName&#39;, &#39;NAMELSAD&#39;,
       &#39;geometry&#39;, &#39;1981&#39;, &#39;1997&#39;, &#39;2006&#39;, &#39;1982&#39;, &#39;1983&#39;, &#39;2012&#39;, &#39;2017&#39;,
       &#39;1985&#39;, &#39;2010&#39;, &#39;2015&#39;, &#39;1980&#39;, &#39;CBSAFP&#39;, &#39;index&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">namedf</span> <span class="o">=</span> <span class="n">usva</span><span class="p">[[</span><span class="s1">&#39;GeoName&#39;</span><span class="p">,</span> <span class="s1">&#39;STATEFP&#39;</span><span class="p">,</span> <span class="s1">&#39;1969&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">namedf</span><span class="p">[</span><span class="n">namedf</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GeoName</th>
      <th>STATEFP</th>
      <th>1969</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>238</th>
      <td>La Paz, AZ*</td>
      <td>04</td>
      <td>(NA)</td>
    </tr>
    <tr>
      <th>239</th>
      <td>La Paz, AZ*</td>
      <td>04</td>
      <td>(NA)</td>
    </tr>
    <tr>
      <th>706</th>
      <td>Broomfield, CO*</td>
      <td>08</td>
      <td>(NA)</td>
    </tr>
    <tr>
      <th>707</th>
      <td>Broomfield, CO*</td>
      <td>08</td>
      <td>(NA)</td>
    </tr>
    <tr>
      <th>5311</th>
      <td>Cibola, NM*</td>
      <td>35</td>
      <td>(NA)</td>
    </tr>
    <tr>
      <th>5312</th>
      <td>Cibola, NM*</td>
      <td>35</td>
      <td>(NA)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">namedf</span><span class="p">[</span><span class="n">namedf</span><span class="o">.</span><span class="n">GeoName</span><span class="o">==</span><span class="s1">&#39;Bedford, VA*&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GeoName</th>
      <th>STATEFP</th>
      <th>1969</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99</th>
      <td>Bedford, VA*</td>
      <td>51</td>
      <td>98697</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Bedford, VA*</td>
      <td>51</td>
      <td>32709</td>
    </tr>
    <tr>
      <th>101</th>
      <td>Bedford, VA*</td>
      <td>51</td>
      <td>3017</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./data/us_county_income"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sergio J. Rey, Dani Arribas-Bel, Levi J. Wolf<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-146598819-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>